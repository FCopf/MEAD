---
title: "IntroduÃ§Ã£o Ã  InferÃªncia Bayesiana"  
subtitle: "De contagens a probabilidades"  
description: Texto adaptado do segundo capÃ­tulo (*Small Worlds and Large Worlds*) do livro **Statistical Rethinking â€“ A Bayesian Course with Examples in R and Stan** [@mcelreath2018statistical] e material disponÃ­vel em [**Statistical Rethinking course and book package**](https://github.com/rmcelreath/rethinking){target="_blank"}  
Categories: ["Probabilidade", "InferÃªncia bayesiana", "teorema de Bayes"]

image: "images/intro-bayes-distr-prob.png"  
execute:  
  echo: false  
  warning: false  
  include: true  
  message: false  

---

---

Voltemos ao problema das bolinhas de gude. Temos uma caixa contendo quatro bolinhas, que podem ser azuis ou brancas. Sabemos que hÃ¡ exatamente quatro bolinhas, mas nÃ£o conhecemos a distribuiÃ§Ã£o entre as cores, pois podemos ver apenas uma bolinha por vez atravÃ©s de um orifÃ­cio. Para estimar quantas bolas de cada cor hÃ¡ na caixa, fazemos uma observaÃ§Ã£o, misturamos as bolinhas, fazemos outra observaÃ§Ã£o e assim por diante. Antes de realizarmos qualquer observaÃ§Ã£o, podemos listar cinco configuraÃ§Ãµes possÃ­veis para o conteÃºdo da caixa:

1. [âšªâšªâšªâšª]  
2. [ğŸ”µâšªâšªâšª]  
3. [ğŸ”µğŸ”µâšªâšª]  
4. [ğŸ”µğŸ”µğŸ”µâšª]  
5. [ğŸ”µğŸ”µğŸ”µğŸ”µ]

Nosso objetivo Ã© *estimar o nÃºmero $N$ de bolas azuis*, o qual pode variar, neste exemplo, de 0 a 4. Como nÃ£o dispomos de conhecimento prÃ©vio sobre a composiÃ§Ã£o da caixa antes da primeira observaÃ§Ã£o, adotamos uma distribuiÃ§Ã£o *a priori* uniforme entre as hipÃ³teses. Assim, cada hipÃ³tese recebe uma probabilidade de $p = \frac{1}{5}$.

| **HipÃ³tese** | **N** | **Priori** |
|:------------:|:-----:|:----------:|
| [âšªâšªâšªâšª]   |  0    | $1/5$    |
| [ğŸ”µâšªâšªâšª]   |  1    | $1/5$    |
| [ğŸ”µğŸ”µâšªâšª]   |  2    | $1/5$    |
| [ğŸ”µğŸ”µğŸ”µâšª]   |  3    | $1/5$    |
| [ğŸ”µğŸ”µğŸ”µğŸ”µ]   |  4    | $1/5$    |

: **DistribuiÃ§Ã£o de probabilidade *a priori* sobre o conteÃºdo da caixa** {#tbl-priori} 

---

## DistribuiÃ§Ãµes *a priori*, *a posteriori* e *verossimilhanÃ§a*

Suponha que realizamos trÃªs observaÃ§Ãµes da caixa e a sequÃªncia registrada seja [ğŸ”µ, âšª, ğŸ”µ] â€“ ou seja, obtivemos **N = 2** bolas azuis. Para atualizar nosso conhecimento sobre a composiÃ§Ã£o da caixa, combinamos nossa distribuiÃ§Ã£o *a priori* com a verossimilhanÃ§a de cada hipÃ³tese. A verossimilhanÃ§a Ã© calculada a partir da contagem do nÃºmero de maneiras em que cada hipÃ³tese pode gerar a sequÃªncia observada. Em seguida, aplicamos a regra de Bayes, que nos fornece a distribuiÃ§Ã£o *a posteriori* por meio da fÃ³rmula:

$$\text{Posterior}_i = \frac{\text{Priori}_i \times P_i}{\sum_{j} \left(\text{Priori}_j \times P_j\right)},$$

onde $P_i$ representa, de forma proporcional, o nÃºmero de caminhos possÃ­veis para que a hipÃ³tese $i$ gere a sequÃªncia [ğŸ”µ, âšª, ğŸ”µ].

Na tabela a seguir, apresentamos os cÃ¡lculos para cada hipÃ³tese:

| **HipÃ³tese** | **N** | **Priori** | **Maneiras de produzir N = 2 [ğŸ”µâšªğŸ”µ]** | **Posterior** |
|:------------:|:-----:|:----------:|:---------------------------------------:|:-------------:|
| [âšªâšªâšªâšª]   |  0    | $1/5$    | $0 \times 4 \times 0 = 0$             | $\dfrac{(1/5 \times 0)}{\sum (1/5 \times \text{NÂº de caminhos})} = 0$  |
| [ğŸ”µâšªâšªâšª]   |  1    | $1/5$    | $1 \times 3 \times 1 = 3$             | $\dfrac{(1/5 \times 3)}{\sum (1/5 \times \text{NÂº de caminhos})} = 0.15$  |
| [ğŸ”µğŸ”µâšªâšª]   |  2    | $1/5$    | $2 \times 2 \times 2 = 8$             | $\dfrac{(1/5 \times 8)}{\sum (1/5 \times \text{NÂº de caminhos})} = 0.40$  |
| [ğŸ”µğŸ”µğŸ”µâšª]   |  3    | $1/5$    | $3 \times 1 \times 3 = 9$             | $\dfrac{(1/5 \times 9)}{\sum (1/5 \times \text{NÂº de caminhos})} = 0.45$  |
| [ğŸ”µğŸ”µğŸ”µğŸ”µ]   |  4    | $1/5$    | $4 \times 0 \times 4 = 0$             | $\dfrac{(1/5 \times 0)}{\sum (1/5 \times \text{NÂº de caminhos})} = 0$  |

: **Tabela: AtualizaÃ§Ã£o da distribuiÃ§Ã£o de probabilidade combinando a priori e verossimilhanÃ§a** {#tbl-posteriori} 

Na @tbl-posteriori, a coluna *â€œManeiras de produzir N = 2 [ğŸ”µâšªğŸ”µ]â€* indica o nÃºmero de caminhos possÃ­veis para que cada hipÃ³tese gere a sequÃªncia observada. Note que as hipÃ³teses [âšªâšªâšªâšª] e [ğŸ”µğŸ”µğŸ”µğŸ”µ] nÃ£o conseguem gerar a sequÃªncia (ou seja, possuem verossimilhanÃ§a zero). 

```{python}
import matplotlib.pyplot as plt
import numpy as np

# NÃºmero de bolas azuis possÃ­veis (0 a 4)
N = np.array([0, 1, 2, 3, 4])

# DistribuiÃ§Ã£o a priori uniforme
prior = np.full_like(N, 1/5, dtype=float)

# NÃºmero de caminhos (verossimilhanÃ§a proporcional) para [ğŸ”µ, âšª, ğŸ”µ]
likelihood = np.array([0, 3, 8, 9, 0])

# Produto da priori pela verossimilhanÃ§a proporcional
unnormalized_posterior = prior * likelihood

# NormalizaÃ§Ã£o
posterior = unnormalized_posterior / unnormalized_posterior.sum()

# Plot
fig, axs = plt.subplots(1, 2, figsize=(2.5*3, 3), sharey=True)

# GrÃ¡fico da distribuiÃ§Ã£o a priori
axs[0].bar(N, prior)
axs[0].set_title("DistribuiÃ§Ã£o a priori")
axs[0].set_xlabel("NÃºmero de bolas azuis (N)")
axs[0].set_ylabel("Probabilidade")
axs[0].set_xticks(N)

# GrÃ¡fico da distribuiÃ§Ã£o a posteriori
axs[1].bar(N, posterior)
axs[1].set_title("DistribuiÃ§Ã£o a posteriori")
axs[1].set_xlabel("NÃºmero de bolas azuis (N)")
axs[1].set_xticks(N)

plt.tight_layout()
plt.show()

```

Ao normalizarmos os produtos $\text{Priori}_i \times P_i$ â€” isto Ã©, dividindo cada um deles pelo somatÃ³rio $\sum (1/5 \times \text{NÂº de caminhos})$ â€” obtemos a distribuiÃ§Ã£o **a posteriori**, que representa nosso conhecimento atualizado apÃ³s considerar as evidÃªncias observadas. O resultado final da inferÃªncia bayesiana Ã© a atribuiÃ§Ã£o de **probabilidades** â€” valores nÃ£o negativos, cuja soma Ã© igual a 1 â€” a cada uma das hipÃ³teses possÃ­veis sobre o conteÃºdo da caixa. Essas probabilidades expressam, de forma quantitativa, o quÃ£o plausÃ­vel Ã© cada hipÃ³tese Ã  luz dos dados disponÃ­veis.