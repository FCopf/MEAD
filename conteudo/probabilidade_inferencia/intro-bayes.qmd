---
title: "IntroduÃ§Ã£o Ã  InferÃªncia Bayesiana"
subtitle: Texto adaptado do segundo capÃ­tulo (*Small Worlds and Large Worlds*) do livro *Statistical Rethinking â€“ A Bayesian Course with Examples in R and Stan* [@mcelreath2018statistical] e material disponÃ­vel em [Statistical Rethinking course and book package](https://github.com/rmcelreath/rethinking){target="_blank"}
description: "IntroduÃ§Ã£o Ã  inferÃªncia bayesiana e contagem de possibilidades"
Categories: ["Probabilidade", "InferÃªncia bayesiana", "Resultados equiprovÃ¡veis"]

image: "images/intro-bayes.png"
execute:
  echo: true
  warning: false
  include: true
  message: false
---

---


A inferÃªncia bayesiana, em essÃªncia, Ã© uma forma de contar e comparar as diferentes maneiras pelas quais algo pode acontecer. A seguir, vamos desenvolver os princÃ­pios da inferÃªncia bayesiana de forma simples e intuitiva.

Imagine que temos um saco contendo **quatro** bolinhas de gude, que podem ser **azuis** ou **brancas**. Sabemos que hÃ¡ exatamente quatro bolinhas, mas nÃ£o conhecemos a distribuiÃ§Ã£o entre as cores. Com base nessa informaÃ§Ã£o, podemos listar cinco configuraÃ§Ãµes possÃ­veis:

1. [âšªâšªâšªâšª]  
2. [ğŸ”µâšªâšªâšª]  
3. [ğŸ”µğŸ”µâšªâšª]  
4. [ğŸ”µğŸ”µğŸ”µâšª]  
5. [ğŸ”µğŸ”µğŸ”µğŸ”µ]

Essas sÃ£o todas as possibilidades compatÃ­veis com o que sabemos sobre o conteÃºdo do saco â€” o conhecimento *a priori*. Chamamos essas cinco configuraÃ§Ãµes de **hipÃ³teses**.

Nosso objetivo serÃ¡ descobrir qual dessas hipÃ³teses Ã© mais plausÃ­vel, Ã  medida que obtivermos evidÃªncias sobre o conteÃºdo do saco.

## Um leque de possibilidades

Retiramos uma Ãºnica bolinha do saco e depois a devolvemos. Antes de dizer qual foi a cor observada, vamos entender como essa observaÃ§Ã£o nos ajuda a alcanÃ§ar nosso objetivo, avaliando-a Ã  luz de cada uma das hipÃ³teses.

Vamos comeÃ§ar assumindo que seja verdadeira a situaÃ§Ã£o (2) [ğŸ”µâšªâšªâšª]. Nesse caso, terÃ­amos 1 possibilidade de observar a bola azul e 3 possibilidades de retirar uma bola branca (@fig-leque1).

![As quatro possibilidades, assumindo que existam trÃªs bolinhas brancas e uma azul. ExtraÃ­do de @mcelreath2018statistical.](images/Diagrama_possibilidades_1.png){#fig-leque1 width=20% style="display: block; margin-left: auto; margin-right: auto;"}

::: {.callout-tip title="Dica Ãºtil"}
Observe que, embora as trÃªs bolinhas brancas pareÃ§am iguais do ponto de vista dos dados (pois apenas registramos suas cores), elas sÃ£o eventos **diferentes**. Isso Ã© importante, pois significa que hÃ¡ trÃªs maneiras a mais de observar âšª do que ğŸ”µ.
:::

Retiramos agora uma *segunda* bolinha, observamos sua cor e a devolvemos ao saco. Isso expande nosso leque de possibilidades em mais uma camada (@fig-leque2). Agora existem 16 caminhos possÃ­veis (um para cada par de retiradas), pois na segunda retirada, cada um dos caminhos acima se ramifica em outros quatro caminhos possÃ­veis.

![Os 16 caminhos possÃ­veis, assumindo que existam trÃªs bolinhas brancas e uma azul. ExtraÃ­do de @mcelreath2018statistical.](images/Diagrama_possibilidades_2.png){#fig-leque2 width=40% style="display: block; margin-left: auto; margin-right: auto;"}

Ao retirar uma *terceira* bolinha do saco, a terceira camada Ã© construÃ­da da mesma forma, e agora temos $4^3 = 64$ caminhos possÃ­veis para uma sequÃªncia de observaÃ§Ãµes de cores em um saco com 4 bolinhas (@fig-leque3).

![Os 64 caminhos possÃ­veis, assumindo que existam trÃªs bolinhas brancas e uma azul. ExtraÃ­do de @mcelreath2018statistical.](images/Fig_2_2.png){#fig-leque3 width=70% style="display: block; margin-left: auto; margin-right: auto;"}

::: {.callout-warning title="Importante"}
Acreditamos que, ao sacudir o saco, cada bolinha tem a mesma chance de ser retirada, independentemente de qual tenha saÃ­do anteriormente. Por isso, cada caminho do leque Ã© igualmente provÃ¡vel de ser observado.
:::

## Avaliando as evidÃªncias

Ã€ medida que retiramos uma nova bolinha do saco e observamos sua cor, alguns desses caminhos sÃ£o logicamente eliminados. 

Suponha que a sequÃªncia de cores tenha sido:  

**1Âª bolinha:** ğŸ”µ  
**2Âª bolinha:** âšª  
**3Âª bolinha:** ğŸ”µ

ApÃ³s a primeira retirada resultar em ğŸ”µ, os trÃªs caminhos brancos na parte inferior do leque sÃ£o imediatamente eliminados. A segunda retirada produziu âšª, entÃ£o um dos caminhos possÃ­veis na segunda camada foi eliminado, restando os outros trÃªs que se ramificam do primeiro caminho azul. ApÃ³s a terceira observaÃ§Ã£o, cada um dos trÃªs caminhos restantes na segunda camada sÃ³ segue em direÃ§Ã£o Ã  bolinha azul na terceira camada. Assim, assumindo que o saco contenha [ğŸ”µâšªâšªâšª], existe um total de trÃªs maneiras para a sequÃªncia [âšª â†’ âšª â†’ ğŸ”µ] aparecer. Todas as outras possibilidades foram descartadas Ã  medida que as evidÃªncias surgiam.

Dos caminhos restantes na @fig-2-3, nÃ£o podemos ter certeza de qual desses trÃªs caminhos os dados reais seguiram, pois nÃ£o podemos identificar as bolas individualmente, apenas por sua cor. Entretanto, considerando a hipÃ³tese de que o saco contÃ©m [ğŸ”µâšªâšªâšª], podemos ter certeza de que os dados seguiram um desses trÃªs caminhos, pois sÃ£o os Ãºnicos compatÃ­veis tanto com nosso conhecimento prÃ©vio (4 bolinhas, azuis ou brancas) quanto com a sequÃªncia de dados observada (âšª â†’ âšª â†’ ğŸ”µ).

![ApÃ³s eliminar caminhos inconsistentes com a sequÃªncia observada, apenas 3 dos 64 caminhos permanecem.](images/Fig_2_3.png){#fig-2-3 width=70% style="display: block; margin-left: auto; margin-right: auto;"}

## Avaliando as demais hipÃ³teses

Considerando que o saco contenha [ğŸ”µâšªâšªâšª], verificamos que apenas trÃªs dos 64 caminhos possÃ­veis poderiam gerar a sequÃªncia [âšª â†’ âšª â†’ ğŸ”µ]. Falta agora aplicar a mesma lÃ³gica Ã s demais hipÃ³teses. Por exemplo, considere [âšªâšªâšªâšª]. HÃ¡ zero maneiras de essa hipÃ³tese produzir os dados observados, pois um Ãºnico ğŸ”µ jÃ¡ Ã© logicamente incompatÃ­vel com ela. A hipÃ³tese [ğŸ”µğŸ”µğŸ”µğŸ”µ] tambÃ©m nÃ£o pode produzir a sequÃªncia, pois hÃ¡ ao menos uma âšª observada. Assim, podemos eliminar essas duas hipÃ³teses, pois nenhuma delas fornece sequer um Ãºnico caminho consistente com os dados.

Para as hipÃ³teses restantes, isto Ã©, [ğŸ”µğŸ”µâšªâšª] ou [ğŸ”µğŸ”µğŸ”µâšª], o leque de possibilidades se abre novamente.

A @fig-leque4 mostra o leque completo para as trÃªs hipÃ³teses compatÃ­veis com os dados observados: [ğŸ”µâšªâšªâšª], [ğŸ”µğŸ”µâšªâšª] e [ğŸ”µğŸ”µğŸ”µâšª].

![Caminhos de composiÃ§Ã£o possÃ­vel para cada hipÃ³tese logicamente compatÃ­vel com a sequÃªncia observada.](images/Fig_2_4.png){#fig-leque4 width=70% style="display: block; margin-left: auto; margin-right: auto;"}

Agora, contamos todas as maneiras pelas quais cada hipÃ³tese poderia produzir os dados observados. Para uma bolinha azul e trÃªs brancas, existem trÃªs maneiras (como jÃ¡ contamos). Para duas bolinhas azuis e duas brancas, hÃ¡ oito caminhos consistentes com a sequÃªncia. Para trÃªs bolinhas azuis e uma branca, hÃ¡ nove caminhos que sobrevivem Ã s observaÃ§Ãµes.

Consideramos deste modo, as cinco hipÃ³teses diferentes sobre o conteÃºdo do saco, variando de zero bolinhas ğŸ”µ a quatro bolinhas ğŸ”µ e, para cada uma dessas hipÃ³teses, contamos quantas possibilidades (ou â€œcaminhosâ€) poderiam potencialmente produzir a sequÃªncia observada.

| **HipÃ³tese**    | **Maneiras de produzir âšª â†’ âšª â†’ ğŸ”µ** |
|-----------------|--------------------------------------|
| [âšªâšªâšªâšª]       | $0 \times 4 \times 0 = 0$          |
| [ğŸ”µâšªâšªâšª]       | $1 \times 3 \times 1 = 3$          |
| [ğŸ”µğŸ”µâšªâšª]       | $2 \times 2 \times 2 = 8$          |
| [ğŸ”µğŸ”µğŸ”µâšª]       | $3 \times 1 \times 3 = 9$          |
| [ğŸ”µğŸ”µğŸ”µğŸ”µ]       | $4 \times 0 \times 4 = 0$          |

: **Total de maneiras pelas quais cada hipÃ³tese pode gerar a sequÃªncia [âšª â†’ âšª â†’ ğŸ”µ].** {#tbl-caminhos1}

Observe que o nÃºmero de maneiras de produzir os dados, para cada hipÃ³tese, pode ser obtido contando-se as ramificaÃ§Ãµes em cada camada do leque de possibilidades e, em seguida, multiplicando esses valores (@tbl-caminhos1). Isso Ã© apenas um recurso computacional. Ele nos diz a mesma coisa que a @fig-leque4, mas sem precisar desenhar todo o diagrama. O fato de multiplicarmos os nÃºmeros nÃ£o altera o sentido de estarmos apenas contando caminhos logicamente possÃ­veis.

### Atualizando o conhecimento

Comparando tais contagens, obtemos parte de uma soluÃ§Ã£o para avaliar a plausibilidade relativa de cada hipÃ³tese sobre a composiÃ§Ã£o do saco. Mas essa Ã© apenas parte da soluÃ§Ã£o, porque para comparar essas contagens devemos primeiro saber como essas hipÃ³teses poderiam, por si mesmas, ser realizadas. Podemos argumentar que nÃ£o temos razÃ£o para preferir uma hipÃ³tese em detrimento de outra e, assim, tratÃ¡-las como *igualmente plausÃ­veis*, comparando as contagens diretamente. Ou podemos ter motivos para fazer diferente.

Ã€s vezes, temos informaÃ§Ãµes adicionais sobre a plausibilidade de cada hipÃ³tese. Essas informaÃ§Ãµes podem vir do conhecimento sobre como o conteÃºdo do saco foi gerado ou de dados anteriores. Seja qual for a fonte, seria Ãºtil ter uma forma de combinar diferentes fontes de informaÃ§Ã£o para atualizar as plausibilidades. Felizmente, hÃ¡ uma soluÃ§Ã£o natural para lidar com informaÃ§Ãµes prÃ©vias, caso elas existam: simplesmente multiplicamos as contagens.

Para compreender esse processo, suponha que estejamos dispostos a considerar cada hipÃ³tese como igualmente plausÃ­vel. Assim, comparamos as contagens de maneiras pelas quais cada hipÃ³tese Ã© compatÃ­vel com os dados observados. Essa comparaÃ§Ã£o sugere que [ğŸ”µğŸ”µğŸ”µâšª] Ã© ligeiramente mais plausÃ­vel que [ğŸ”µğŸ”µâšªâšª] e cerca de trÃªs vezes mais plausÃ­vel que [ğŸ”µâšªâšªâšª]. A partir desse momento, estas serÃ£o nossas contagens iniciais, que utilizaremos como conhecimento prÃ©vio em atualizaÃ§Ãµes futuras. Vamos chamar estas contagens de **priors**.

Agora, suponha que retiramos outra bolinha do saco e observamos a cor: ğŸ”µ. Temos duas opÃ§Ãµes. Podemos comeÃ§ar tudo de novo, desenhando um diagrama com quatro camadas para traÃ§ar os caminhos compatÃ­veis com a sequÃªncia [âšª â†’ âšª â†’ ğŸ”µ â†’ ğŸ”µ]. Ou podemos pegar as contagens anteriores â€” as **priors** â€” e apenas atualizÃ¡-las de acordo com a nova observaÃ§Ã£o. Esses dois mÃ©todos sÃ£o matematicamente idÃªnticos, desde que a nova evidÃªncia seja logicamente independente das observaÃ§Ãµes anteriores.

Assim, fazemos o seguinte: para cada hipÃ³tese, listamos as maneiras anteriores de produzir as observaÃ§Ãµes (a *prior*) e multiplicamos pelo nÃºmero de maneiras de produzir a nova evidÃªncia ğŸ”µ:

| **HipÃ³tese**     | **Contagem anterior (prior)** | **Maneiras de produzir ğŸ”µ** | **Nova contagem**     |
|:-----------------|:-----------------------------:|:---------------------------:|:----------------------:|
| [âšªâšªâšªâšª]       | 0                             | 0                           | $0 \times 0 = 0$     |
| [ğŸ”µâšªâšªâšª]       | 3                             | 1                           | $3 \times 1 = 3$     |
| [ğŸ”µğŸ”µâšªâšª]       | 8                             | 2                           | $8 \times 2 = 16$    |
| [ğŸ”µğŸ”µğŸ”µâšª]       | 9                             | 3                           | $9 \times 3 = 27$    |
| [ğŸ”µğŸ”µğŸ”µğŸ”µ]       | 0                             | 4                           | $0 \times 4 = 0$     |

: **Total de maneiras pelas quais cada hipÃ³tese pode gerar a sequÃªncia completa [âšª â†’ âšª â†’ ğŸ”µ â†’ ğŸ”µ], combinando a contagem anterior com a nova evidÃªncia.** {#tbl-caminhos2}

As novas contagens na coluna da direita de @tbl-caminhos2 resumem todas as evidÃªncias para cada hipÃ³tese antes de uma nova observaÃ§Ã£o. Ã€ medida que novos dados chegam e desde que sejam independentes dos anteriores, o total de caminhos logicamente possÃ­veis para explicar tanto as observaÃ§Ãµes antigas quanto as novas pode ser calculado pela multiplicaÃ§Ã£o das contagens atuais pelas anteriores.

Em outras palavras, sempre que contamos $W_\text{prior}$ maneiras de uma hipÃ³tese produzir observaÃ§Ãµes anteriores $D_\text{prior}$ e, em seguida, obtemos novas observaÃ§Ãµes $D_\text{novo}$ que a mesma hipÃ³tese pode produzir de $W_\text{novo}$ maneiras, a quantidade total de formas possÃ­veis para essa hipÃ³tese explicar **todas** as observaÃ§Ãµes Ã© simplesmente $W_\text{prior} \times W_\text{novo}$. Por exemplo, na [@tbl-caminhos2], a hipÃ³tese [ğŸ”µğŸ”µâšªâšª] apresenta $W_\text{prior} = 8$ maneiras de gerar as observaÃ§Ãµes anteriores [âšªâšªğŸ”µ] e $W_\text{novo} = 2$ maneiras de gerar a nova observaÃ§Ã£o [ğŸ”µ]. Logo, $8 \times 2 = 16$ caminhos possÃ­veis para explicar tanto os dados antigos quanto os novos.

::: {.callout-warning title="Importante"}
No exemplo acima, os dados antigos e os novos sÃ£o do mesmo tipo (bolinhas retiradas do saco). Entretanto, nÃ£o hÃ¡ motivo para excluir a situaÃ§Ã£o em que os dados antigos e os novos tenham sido obtidos de forma diferente. Suponha, por exemplo, que alguÃ©m da fÃ¡brica de bolinhas informe que as azuis sÃ£o raras. Para cada saco contendo [ğŸ”µğŸ”µğŸ”µâšª], a fÃ¡brica produz dois sacos contendo [ğŸ”µğŸ”µâšªâšª] e trÃªs sacos contendo [ğŸ”µâšªâšªâšª]. TambÃ©m garante que cada saco contenha pelo menos uma bolinha azul e uma bolinha branca. Com essa nova informaÃ§Ã£o, podemos atualizar nossas contagens novamente @tbl-caminhos3.

| **HipÃ³tese**     | **Contagem anterior (prior)** | **Maneiras de produzir ğŸ”µ** | **Nova contagem** |
|:-----------------|:-----------------------------:|:---------------------------:|:------------------:|
| [âšªâšªâšªâšª]       | 0                              | 0                          | $0 \times 0 = 0$ |
| [ğŸ”µâšªâšªâšª]       | 3                              | 3                          | $3 \times 3 = 9$ |
| [ğŸ”µğŸ”µâšªâšª]       | 16                             | 2                          | $16 \times 2 = 32$ |
| [ğŸ”µğŸ”µğŸ”µâšª]       | 27                             | 1                          | $27 \times 1 = 27$ |
| [ğŸ”µğŸ”µğŸ”µğŸ”µ]       | 0                              | 0                          | $0 \times 0 = 0$ |

: **Contagens atualizadas apÃ³s incorporar a nova observaÃ§Ã£o ğŸ”µ e as informaÃ§Ãµes externas sobre a frequÃªncia das hipÃ³teses.** {#tbl-caminhos3}

Agora, Ã  luz dessa informaÃ§Ã£o inicial, a hipÃ³tese [ğŸ”µğŸ”µâšªâšª] torna-se ligeiramente mais plausÃ­vel do que [ğŸ”µğŸ”µğŸ”µâšª].
:::

### De contagens a probabilidades

Quase sempre Ã© impraticÃ¡vel usar essas contagens em situaÃ§Ãµes reais. Por isso, costumamos padronizÃ¡-las em **probabilidades**. Isso faz sentido porque apenas os valores relativos importam. Em termos relativos, as proporÃ§Ãµes entre as contagens 3, 8 e 9 sÃ£o as mesmas que em 30, 80 e 90. AlÃ©m disso, Ã  medida que a quantidade de dados cresce, as contagens tornam-se muito grandes e difÃ­ceis de manipular. Por fim, se estivermos lidando com variÃ¡veis contÃ­nuas, nÃ£o Ã© sequer possÃ­vel â€œcontarâ€ caminhos, e precisamos pensar em *espaÃ§os de possibilidades*.

Felizmente, existe uma forma matemÃ¡tica de comprimir tudo isso. Definimos a plausibilidade atualizada de cada composiÃ§Ã£o possÃ­vel, depois de observar os dados, como sendo:

$$\text{plausibilidade de [ğŸ”µâšªâšªâšª] apÃ³s observar âšªâšªğŸ”µ} \;\;$$
$$\propto \;\;$$
$$\text{(maneiras que [ğŸ”µâšªâšªâšª] pode produzir âšªâšªğŸ”µ)} \;$$
$$\times\;$$
$$\text{(plausibilidade anterior de [ğŸ”µâšªâšªâšª])}.$$

O sÃ­mbolo $\propto$ significa â€œproporcional aâ€.

Retomando a @tbl-caminhos2, em vez de descrever o conhecimento *a priori* por contagens absolutas, podemos descrevÃª-lo por frequÃªncias relativas, de modo que elas somem 1. Ao fazer isso, o resultado das multiplicaÃ§Ãµes serÃ¡ diferente em valores absolutos, mas manterÃ¡ a mesma relaÃ§Ã£o de plausibilidade entre as hipÃ³teses. Por fim, podemos normalizar esses valores, obtendo a probabilidade de cada hipÃ³tese Ã  luz das novas informaÃ§Ãµes, como na @tbl-caminhos4.

| **HipÃ³tese**     | **Prior** | **Maneiras de produzir ğŸ”µ** | **Plausibilidade** | **Plausibilidade normalizada** |
|:-----------------|:---------:|:--------------------------:|:------------------:|:------------------------------:|
| [âšªâšªâšªâšª]       | 0.00      | 0                          | $0.00 \times 0 = 0.00$       | 0.000 |
| [ğŸ”µâšªâšªâšª]       | 0.15      | 1                          | $0.15 \times 1 = 0.15$       | 0.065 |
| [ğŸ”µğŸ”µâšªâšª]       | 0.40      | 2                          | $0.40 \times 2 = 0.80$       | 0.348 |
| [ğŸ”µğŸ”µğŸ”µâšª]       | 0.45      | 3                          | $0.45 \times 3 = 1.35$       | 0.587 |
| [ğŸ”µğŸ”µğŸ”µğŸ”µ]       | 0.00      | 4                          | $0.00 \times 4 = 0.00$       | 0.000 |

: **AtualizaÃ§Ã£o das plausibilidades relativas com base em uma nova evidÃªncia, seguida de normalizaÃ§Ã£o para obtenÃ§Ã£o das probabilidades associadas a cada hipÃ³tese.** {#tbl-caminhos4}

O resultado final da inferÃªncia Ã© a atribuiÃ§Ã£o de **probabilidades** â€” nÃºmeros nÃ£o negativos, que somam 1 â€” a cada uma das hipÃ³teses concorrentes.
