<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Manipulação e transformação de dados com as funções principais do Tidyverse, incluindo dplyr e tidyr.">

<title>Transformação de Dados – Modelagem Estatística e Análise de Dados</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-57e38ebe45bd79b94795dbeeddd9c4b4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles/custom.css">
<meta property="og:title" content="Transformação de Dados – Modelagem Estatística e Análise de Dados">
<meta property="og:description" content="Manipulação e transformação de dados com as funções principais do Tidyverse, incluindo dplyr e tidyr.">
<meta property="og:image" content="https://github.com/FCopf/MEAD/conteudo/manipulacao-dados-R/images/transform.jpg">
<meta property="og:site_name" content="Modelagem Estatística e Análise de Dados">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/MEAD-logo-white-sigla.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Modelagem Estatística e Análise de Dados</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Procurar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Alternar de navegação" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/FCopf/MEAD"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Nesta página</h2>
   
  <ul>
  <li><a href="#ordenando-as-linhas-funções-arrange-e-desc" id="toc-ordenando-as-linhas-funções-arrange-e-desc" class="nav-link active" data-scroll-target="#ordenando-as-linhas-funções-arrange-e-desc"><span class="header-section-number">1</span> Ordenando as linhas: funções <code>arrange()</code> e <code>desc()</code></a></li>
  <li><a href="#filtrando-linhas-função-filter" id="toc-filtrando-linhas-função-filter" class="nav-link" data-scroll-target="#filtrando-linhas-função-filter"><span class="header-section-number">2</span> Filtrando linhas: função <code>filter()</code></a></li>
  <li><a href="#selecionando-colunas-função-select" id="toc-selecionando-colunas-função-select" class="nav-link" data-scroll-target="#selecionando-colunas-função-select"><span class="header-section-number">3</span> Selecionando colunas: função <code>select()</code></a>
  <ul class="collapse">
  <li><a href="#selecionandoexcluindo-variáveis-numéricas-e-categóricas" id="toc-selecionandoexcluindo-variáveis-numéricas-e-categóricas" class="nav-link" data-scroll-target="#selecionandoexcluindo-variáveis-numéricas-e-categóricas"><span class="header-section-number">3.1</span> Selecionando/Excluindo variáveis numéricas e categóricas</a></li>
  <li><a href="#exclusão-de-variáveis" id="toc-exclusão-de-variáveis" class="nav-link" data-scroll-target="#exclusão-de-variáveis"><span class="header-section-number">3.2</span> Exclusão de variáveis</a></li>
  </ul></li>
  <li><a href="#outros-exemplos-de-seleçãoexclusão-de-variáveis" id="toc-outros-exemplos-de-seleçãoexclusão-de-variáveis" class="nav-link" data-scroll-target="#outros-exemplos-de-seleçãoexclusão-de-variáveis"><span class="header-section-number">4</span> Outros exemplos de seleção/exclusão de variáveis</a>
  <ul class="collapse">
  <li><a href="#all_off-any_of-one_of" id="toc-all_off-any_of-one_of" class="nav-link" data-scroll-target="#all_off-any_of-one_of"><span class="header-section-number">4.1</span> <code>all_off()</code>, <code>any_of()</code>, <code>one_of()</code></a></li>
  <li><a href="#contains-ends_with-everything-last_col" id="toc-contains-ends_with-everything-last_col" class="nav-link" data-scroll-target="#contains-ends_with-everything-last_col"><span class="header-section-number">4.2</span> <code>contains()</code>, <code>ends_with()</code>, <code>everything()</code>, <code>last_col()</code></a></li>
  <li><a href="#expressoes-regulares" id="toc-expressoes-regulares" class="nav-link" data-scroll-target="#expressoes-regulares"><span class="header-section-number">4.3</span> Expressoes regulares</a></li>
  </ul></li>
  <li><a href="#renomeando-colunas" id="toc-renomeando-colunas" class="nav-link" data-scroll-target="#renomeando-colunas"><span class="header-section-number">5</span> Renomeando colunas</a></li>
  <li><a href="#agrupando-tabelas-funções-do-grupo-join" id="toc-agrupando-tabelas-funções-do-grupo-join" class="nav-link" data-scroll-target="#agrupando-tabelas-funções-do-grupo-join"><span class="header-section-number">6</span> Agrupando tabelas: funções do grupo <code>join</code></a>
  <ul class="collapse">
  <li><a href="#função-left_join" id="toc-função-left_join" class="nav-link" data-scroll-target="#função-left_join">Função left_join()</a></li>
  <li><a href="#função-right_join" id="toc-função-right_join" class="nav-link" data-scroll-target="#função-right_join">Função right_join()</a></li>
  <li><a href="#função-inner_join" id="toc-função-inner_join" class="nav-link" data-scroll-target="#função-inner_join">Função inner_join()</a></li>
  <li><a href="#função-anti_join" id="toc-função-anti_join" class="nav-link" data-scroll-target="#função-anti_join">Função anti_join()</a></li>
  <li><a href="#função-full_join" id="toc-função-full_join" class="nav-link" data-scroll-target="#função-full_join">Função full_join()</a></li>
  </ul></li>
  <li><a href="#criando-e-modificando-colunas-com-mutate" id="toc-criando-e-modificando-colunas-com-mutate" class="nav-link" data-scroll-target="#criando-e-modificando-colunas-com-mutate"><span class="header-section-number">7</span> Criando e modificando colunas com <code>mutate()</code></a>
  <ul class="collapse">
  <li><a href="#ajustando-a-escala-de-ph" id="toc-ajustando-a-escala-de-ph" class="nav-link" data-scroll-target="#ajustando-a-escala-de-ph">Ajustando a escala de pH</a></li>
  <li><a href="#criando-variável-categórica" id="toc-criando-variável-categórica" class="nav-link" data-scroll-target="#criando-variável-categórica">Criando variável categórica</a></li>
  <li><a href="#unindo-colunas-com-unite" id="toc-unindo-colunas-com-unite" class="nav-link" data-scroll-target="#unindo-colunas-com-unite">Unindo colunas com <code>unite()</code></a></li>
  </ul></li>
  <li><a href="#reformatando-data-frames-funções-pivot_wider-e-pivot_longer" id="toc-reformatando-data-frames-funções-pivot_wider-e-pivot_longer" class="nav-link" data-scroll-target="#reformatando-data-frames-funções-pivot_wider-e-pivot_longer"><span class="header-section-number">8</span> Reformatando data frames: funções <code>pivot_wider()</code> e <code>pivot_longer()</code></a>
  <ul class="collapse">
  <li><a href="#reorganizando-data-frames-de-formato-longo-para-formato-largo" id="toc-reorganizando-data-frames-de-formato-longo-para-formato-largo" class="nav-link" data-scroll-target="#reorganizando-data-frames-de-formato-longo-para-formato-largo">Reorganizando data frames de formato longo para formato largo</a></li>
  <li><a href="#reorganizando-data-frames-de-formato-largo-para-formato-longo" id="toc-reorganizando-data-frames-de-formato-largo-para-formato-longo" class="nav-link" data-scroll-target="#reorganizando-data-frames-de-formato-largo-para-formato-longo">Reorganizando data frames de formato largo para formato longo</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Transformação de Dados</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Ciência de dados</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">Tidyverse</div>
    <div class="quarto-category">Transformação de dados</div>
  </div>
  </div>

<div>
  <div class="description">
    Manipulação e transformação de dados com as funções principais do Tidyverse, incluindo <code>dplyr</code> e <code>tidyr</code>.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Após importar uma base de dados para o R, os pacotes <code>dplyr</code> e <code>tidyr</code> são essenciais para transformação de data frames. As funções desses pacotes ajudam na análise, modelagem e comunicação de dados. Neste seção são apresentadas as principais funções para transformar observações (linhas) e variáveis em um data frame a partir de uma ou mais tabelas. A <a href="https://rstudio.com/resources/cheatsheets/">Cheatsheets</a> do <code>dplyr</code> apresenta outros recursos não discutidos nesta seção.</p>
<section id="ordenando-as-linhas-funções-arrange-e-desc" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="ordenando-as-linhas-funções-arrange-e-desc"><span class="header-section-number">1</span> Ordenando as linhas: funções <code>arrange()</code> e <code>desc()</code></h2>
<p>As funções <code>arrange()</code> e <code>desc()</code> permitem ordenar a base de dados com base nos valores de uma ou mais colunas. Usará-se o conjunto de dados <code>iris</code> como exemplo.</p>
<p>Carregue os pacote <code>dplyr</code>, <code>tidyr</code> e <code>readr</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para carregar e visualizar as primeiras linhas da base de dados <code>iris</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"iris"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris, <span class="dv">10</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1           5.1         3.5          1.4         0.2  setosa
2           4.9         3.0          1.4         0.2  setosa
3           4.7         3.2          1.3         0.2  setosa
4           4.6         3.1          1.5         0.2  setosa
5           5.0         3.6          1.4         0.2  setosa
6           5.4         3.9          1.7         0.4  setosa
7           4.6         3.4          1.4         0.3  setosa
8           5.0         3.4          1.5         0.2  setosa
9           4.4         2.9          1.4         0.2  setosa
10          4.9         3.1          1.5         0.1  setosa</code></pre>
</div>
</div>
<p>Para ordenar a tabela pela coluna <code>Sepal.Length</code> em ordem crescente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Sepal.Length)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ordenar em ordem decrescente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Sepal.Length))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>É possível também combinar duas colunas, ordenando a tabela pela coluna <code>Species</code> (em ordem alfabética decrescente) e <code>Sepal.Length</code> (em ordem crescente):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Species), Sepal.Length)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para criar um novo objeto com a tabela ordenada</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>iris_ordenado <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Sepal.Length)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>iris_ordenado</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filtrando-linhas-função-filter" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="filtrando-linhas-função-filter"><span class="header-section-number">2</span> Filtrando linhas: função <code>filter()</code></h2>
<p>A função <code>filter()</code> extrai linhas que satisfazem uma condição lógica. Para filtrar as linhas referentes à espécie <code>virginica</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">"virginica"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para filtrar espécies diferentes de <code>virginica</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">!=</span> <span class="st">"virginica"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para filtrar linhas onde o comprimento das pétalas seja menor que <span class="math inline">\(1.3\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Petal.Length <span class="sc">&lt;</span> <span class="fl">1.3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para filtrar onde o comprimento das pétalas seja menor que <span class="math inline">\(1.3\)</span> e o comprimento das sépalas seja maior ou igual a <span class="math inline">\(5\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Petal.Length <span class="sc">&lt;</span> <span class="fl">1.3</span> <span class="sc">&amp;</span> Sepal.Length <span class="sc">&gt;=</span> <span class="dv">5</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="selecionando-colunas-função-select" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="selecionando-colunas-função-select"><span class="header-section-number">3</span> Selecionando colunas: função <code>select()</code></h2>
<p>A função <code>select()</code> permite extrair ou reorganizar um subconjunto de colunas de um data frame.</p>
<p>Para extrair uma coluna:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Petal.Length)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para extrair múltiplas colunas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Petal.Length, Species)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para extrair um intervalo de colunas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Petal.Length<span class="sc">:</span>Species)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para excluir uma coluna:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Petal.Length)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para excluir colunas específicas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(Petal.Length, Species))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para selecionar colunas que começam com “Sepal”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Sepal"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para combinar <code>filter()</code> e <code>select()</code> a fim de extrair um subconjunto do data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Sepal"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sepal.Length <span class="sc">&lt;=</span> <span class="fl">4.5</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="selecionandoexcluindo-variáveis-numéricas-e-categóricas" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="selecionandoexcluindo-variáveis-numéricas-e-categóricas"><span class="header-section-number">3.1</span> Selecionando/Excluindo variáveis numéricas e categóricas</h3>
<p>Importe o conjuntoi de dados <code>Reservatorios_Parana_parcial.csv</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/Reservatorios_Parana_parcial.csv"</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">delim =</span> <span class="st">','</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">'.'</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">encoding =</span> <span class="st">'latin1'</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="seleção-de-variáveis-categóricas" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="seleção-de-variáveis-categóricas"><span class="header-section-number">3.1.1</span> Seleção de variáveis categóricas</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Reservatorio, Bacia, Trofia)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 3
   Reservatorio Bacia  Trofia       
   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;        
 1 Cavernoso    Iguacu OligotrÃ³fico
 2 Curucaca     Iguacu OligotrÃ³fico
 3 Foz do Areia Iguacu OligotrÃ³fico
 4 Irai         Iguacu EutrÃ³fico   
 5 JMF          Iguacu MesotrÃ³fico 
 6 Jordao       Iguacu OligotrÃ³fico
 7 Passauna     Iguacu OligotrÃ³fico
 8 Piraquara    Iguacu OligotrÃ³fico
 9 Salto Caxias Iguacu OligotrÃ³fico
10 Salto do Vau Iguacu OligotrÃ³fico
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.character))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 3
   Reservatorio Bacia  Trofia       
   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;        
 1 Cavernoso    Iguacu OligotrÃ³fico
 2 Curucaca     Iguacu OligotrÃ³fico
 3 Foz do Areia Iguacu OligotrÃ³fico
 4 Irai         Iguacu EutrÃ³fico   
 5 JMF          Iguacu MesotrÃ³fico 
 6 Jordao       Iguacu OligotrÃ³fico
 7 Passauna     Iguacu OligotrÃ³fico
 8 Piraquara    Iguacu OligotrÃ³fico
 9 Salto Caxias Iguacu OligotrÃ³fico
10 Salto do Vau Iguacu OligotrÃ³fico
# ℹ 21 more rows</code></pre>
</div>
</div>
</section>
<section id="seleção-de-variáveis-numéricas" class="level4" data-number="3.1.2">
<h4 data-number="3.1.2" class="anchored" data-anchor-id="seleção-de-variáveis-numéricas"><span class="header-section-number">3.1.2</span> Seleção de variáveis numéricas</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Fechamento, Area, pH, Condutividade, Alcalinidade, P.total, Riqueza, CPUE)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 8
   Fechamento   Area    pH Condutividade Alcalinidade P.total Riqueza  CPUE
        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1       1965   2.9    7.4          33.1        140.      7.8      18  9.22
 2       1982   2      7            32.4        126.      4.7      16 28.7 
 3       1980 139      7.3          35.5         97      14.3      19 11.6 
 4       2000  15      6.9          50.2          3.3    53.4      12 30.8 
 5       1970   0.45   7.3          40.2          3.7    41.2      18  5.95
 6       1996   3.4    7.1          23.7        153.      3.3      17  7.75
 7       1978  14      8.8         126.         526      15.2      11  7.51
 8       1979   3.3    7.1          22.8         50.7     4.5       8  4.01
 9       1998 124      7.3          39.6        106      12.1      21 20.8 
10       1959   2.9    6.5          23.2        279      11         8  2.43
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Fechamento, Area, pH<span class="sc">:</span>CPUE)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 8
   Fechamento   Area    pH Condutividade Alcalinidade P.total Riqueza  CPUE
        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1       1965   2.9    7.4          33.1        140.      7.8      18  9.22
 2       1982   2      7            32.4        126.      4.7      16 28.7 
 3       1980 139      7.3          35.5         97      14.3      19 11.6 
 4       2000  15      6.9          50.2          3.3    53.4      12 30.8 
 5       1970   0.45   7.3          40.2          3.7    41.2      18  5.95
 6       1996   3.4    7.1          23.7        153.      3.3      17  7.75
 7       1978  14      8.8         126.         526      15.2      11  7.51
 8       1979   3.3    7.1          22.8         50.7     4.5       8  4.01
 9       1998 124      7.3          39.6        106      12.1      21 20.8 
10       1959   2.9    6.5          23.2        279      11         8  2.43
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 8
   Fechamento   Area    pH Condutividade Alcalinidade P.total Riqueza  CPUE
        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1       1965   2.9    7.4          33.1        140.      7.8      18  9.22
 2       1982   2      7            32.4        126.      4.7      16 28.7 
 3       1980 139      7.3          35.5         97      14.3      19 11.6 
 4       2000  15      6.9          50.2          3.3    53.4      12 30.8 
 5       1970   0.45   7.3          40.2          3.7    41.2      18  5.95
 6       1996   3.4    7.1          23.7        153.      3.3      17  7.75
 7       1978  14      8.8         126.         526      15.2      11  7.51
 8       1979   3.3    7.1          22.8         50.7     4.5       8  4.01
 9       1998 124      7.3          39.6        106      12.1      21 20.8 
10       1959   2.9    6.5          23.2        279      11         8  2.43
# ℹ 21 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="exclusão-de-variáveis" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="exclusão-de-variáveis"><span class="header-section-number">3.2</span> Exclusão de variáveis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Fechamento, <span class="sc">-</span>Area)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 9
   Reservatorio Bacia  Trofia      pH Condutividade Alcalinidade P.total Riqueza
   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 Cavernoso    Iguacu Oligotr…   7.4          33.1        140.      7.8      18
 2 Curucaca     Iguacu Oligotr…   7            32.4        126.      4.7      16
 3 Foz do Areia Iguacu Oligotr…   7.3          35.5         97      14.3      19
 4 Irai         Iguacu EutrÃ³f…   6.9          50.2          3.3    53.4      12
 5 JMF          Iguacu MesotrÃ…   7.3          40.2          3.7    41.2      18
 6 Jordao       Iguacu Oligotr…   7.1          23.7        153.      3.3      17
 7 Passauna     Iguacu Oligotr…   8.8         126.         526      15.2      11
 8 Piraquara    Iguacu Oligotr…   7.1          22.8         50.7     4.5       8
 9 Salto Caxias Iguacu Oligotr…   7.3          39.6        106      12.1      21
10 Salto do Vau Iguacu Oligotr…   6.5          23.2        279      11         8
# ℹ 21 more rows
# ℹ 1 more variable: CPUE &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">where</span>(is.numeric))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 3
   Reservatorio Bacia  Trofia       
   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;        
 1 Cavernoso    Iguacu OligotrÃ³fico
 2 Curucaca     Iguacu OligotrÃ³fico
 3 Foz do Areia Iguacu OligotrÃ³fico
 4 Irai         Iguacu EutrÃ³fico   
 5 JMF          Iguacu MesotrÃ³fico 
 6 Jordao       Iguacu OligotrÃ³fico
 7 Passauna     Iguacu OligotrÃ³fico
 8 Piraquara    Iguacu OligotrÃ³fico
 9 Salto Caxias Iguacu OligotrÃ³fico
10 Salto do Vau Iguacu OligotrÃ³fico
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">where</span>(is.character))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 8
   Fechamento   Area    pH Condutividade Alcalinidade P.total Riqueza  CPUE
        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1       1965   2.9    7.4          33.1        140.      7.8      18  9.22
 2       1982   2      7            32.4        126.      4.7      16 28.7 
 3       1980 139      7.3          35.5         97      14.3      19 11.6 
 4       2000  15      6.9          50.2          3.3    53.4      12 30.8 
 5       1970   0.45   7.3          40.2          3.7    41.2      18  5.95
 6       1996   3.4    7.1          23.7        153.      3.3      17  7.75
 7       1978  14      8.8         126.         526      15.2      11  7.51
 8       1979   3.3    7.1          22.8         50.7     4.5       8  4.01
 9       1998 124      7.3          39.6        106      12.1      21 20.8 
10       1959   2.9    6.5          23.2        279      11         8  2.43
# ℹ 21 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="outros-exemplos-de-seleçãoexclusão-de-variáveis" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="outros-exemplos-de-seleçãoexclusão-de-variáveis"><span class="header-section-number">4</span> Outros exemplos de seleção/exclusão de variáveis</h2>
<section id="all_off-any_of-one_of" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="all_off-any_of-one_of"><span class="header-section-number">4.1</span> <code>all_off()</code>, <code>any_of()</code>, <code>one_of()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. all_of(): Seleciona todas as colunas mencionadas</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">'Reservatorio'</span>, <span class="st">'Bacia'</span>)))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 2
   Reservatorio Bacia 
   &lt;chr&gt;        &lt;chr&gt; 
 1 Cavernoso    Iguacu
 2 Curucaca     Iguacu
 3 Foz do Areia Iguacu
 4 Irai         Iguacu
 5 JMF          Iguacu
 6 Jordao       Iguacu
 7 Passauna     Iguacu
 8 Piraquara    Iguacu
 9 Salto Caxias Iguacu
10 Salto do Vau Iguacu
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. any_of(): Seleciona qualquer coluna que exista na lista (ignora colunas inexistentes)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">'Reservatorio'</span>, <span class="st">'Bacia'</span>, <span class="st">'Turbidez'</span>))) <span class="co"># funciona, any_of() ignora que `Turbidez` não existe</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 2
   Reservatorio Bacia 
   &lt;chr&gt;        &lt;chr&gt; 
 1 Cavernoso    Iguacu
 2 Curucaca     Iguacu
 3 Foz do Areia Iguacu
 4 Irai         Iguacu
 5 JMF          Iguacu
 6 Jordao       Iguacu
 7 Passauna     Iguacu
 8 Piraquara    Iguacu
 9 Salto Caxias Iguacu
10 Salto do Vau Iguacu
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">one_of</span>(<span class="fu">c</span>(<span class="st">'Reservatorio'</span>, <span class="st">'Trofia'</span>, <span class="st">'Turbidez'</span>))) <span class="co"># funciona, one_of() avisa que `Turbidez` não existe</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 2
   Reservatorio Trofia       
   &lt;chr&gt;        &lt;chr&gt;        
 1 Cavernoso    OligotrÃ³fico
 2 Curucaca     OligotrÃ³fico
 3 Foz do Areia OligotrÃ³fico
 4 Irai         EutrÃ³fico   
 5 JMF          MesotrÃ³fico 
 6 Jordao       OligotrÃ³fico
 7 Passauna     OligotrÃ³fico
 8 Piraquara    OligotrÃ³fico
 9 Salto Caxias OligotrÃ³fico
10 Salto do Vau OligotrÃ³fico
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># res |&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Reservatorio, Bacia, Turbidez) # Não funciona, pois `Turbidez` não existe</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="contains-ends_with-everything-last_col" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="contains-ends_with-everything-last_col"><span class="header-section-number">4.2</span> <code>contains()</code>, <code>ends_with()</code>, <code>everything()</code>, <code>last_col()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. contains(): Seleciona colunas cujos nomes contêm uma string específica</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">'to'</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 3
   Reservatorio Fechamento P.total
   &lt;chr&gt;             &lt;dbl&gt;   &lt;dbl&gt;
 1 Cavernoso          1965     7.8
 2 Curucaca           1982     4.7
 3 Foz do Areia       1980    14.3
 4 Irai               2000    53.4
 5 JMF                1970    41.2
 6 Jordao             1996     3.3
 7 Passauna           1978    15.2
 8 Piraquara          1979     4.5
 9 Salto Caxias       1998    12.1
10 Salto do Vau       1959    11  
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. ends_with(): Seleciona colunas que terminam com uma string específica</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">'dade'</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 2
   Condutividade Alcalinidade
           &lt;dbl&gt;        &lt;dbl&gt;
 1          33.1        140. 
 2          32.4        126. 
 3          35.5         97  
 4          50.2          3.3
 5          40.2          3.7
 6          23.7        153. 
 7         126.         526  
 8          22.8         50.7
 9          39.6        106  
10          23.2        279  
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. everything(): Seleciona todas as colunas (pode ser usado para reorganizar)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Fechamento, pH, <span class="fu">everything</span>())</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 11
   Fechamento    pH Reservatorio Bacia    Area Trofia Condutividade Alcalinidade
        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;        &lt;dbl&gt;
 1       1965   7.4 Cavernoso    Iguacu   2.9  Oligo…          33.1        140. 
 2       1982   7   Curucaca     Iguacu   2    Oligo…          32.4        126. 
 3       1980   7.3 Foz do Areia Iguacu 139    Oligo…          35.5         97  
 4       2000   6.9 Irai         Iguacu  15    EutrÃ…          50.2          3.3
 5       1970   7.3 JMF          Iguacu   0.45 Mesot…          40.2          3.7
 6       1996   7.1 Jordao       Iguacu   3.4  Oligo…          23.7        153. 
 7       1978   8.8 Passauna     Iguacu  14    Oligo…         126.         526  
 8       1979   7.1 Piraquara    Iguacu   3.3  Oligo…          22.8         50.7
 9       1998   7.3 Salto Caxias Iguacu 124    Oligo…          39.6        106  
10       1959   6.5 Salto do Vau Iguacu   2.9  Oligo…          23.2        279  
# ℹ 21 more rows
# ℹ 3 more variables: P.total &lt;dbl&gt;, Riqueza &lt;dbl&gt;, CPUE &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. last_col(): Seleciona a última coluna</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">last_col</span>())</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 1
    CPUE
   &lt;dbl&gt;
 1  9.22
 2 28.7 
 3 11.6 
 4 30.8 
 5  5.95
 6  7.75
 7  7.51
 8  4.01
 9 20.8 
10  2.43
# ℹ 21 more rows</code></pre>
</div>
</div>
</section>
<section id="expressoes-regulares" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="expressoes-regulares"><span class="header-section-number">4.3</span> Expressoes regulares</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. matches(): Seleciona colunas que correspondem a uma expressão regular</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">'^[FA]'</span>)) <span class="co"># Colunas que começam com 'F ou A'</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 3
   Fechamento   Area Alcalinidade
        &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;
 1       1965   2.9         140. 
 2       1982   2           126. 
 3       1980 139            97  
 4       2000  15             3.3
 5       1970   0.45          3.7
 6       1996   3.4         153. 
 7       1978  14           526  
 8       1979   3.3          50.7
 9       1998 124           106  
10       1959   2.9         279  
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Seleciona colunas cujos nomes:</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Começam com a letra "A" ou "C"</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Podem conter qualquer sequência de caracteres após a primeira letra</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Terminam com as letras "a" ou "e"</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">'^[AC].*[ae]$'</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 4
     Area Condutividade Alcalinidade  CPUE
    &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;
 1   2.9           33.1        140.   9.22
 2   2             32.4        126.  28.7 
 3 139             35.5         97   11.6 
 4  15             50.2          3.3 30.8 
 5   0.45          40.2          3.7  5.95
 6   3.4           23.7        153.   7.75
 7  14            126.         526    7.51
 8   3.3           22.8         50.7  4.01
 9 124             39.6        106   20.8 
10   2.9           23.2        279    2.43
# ℹ 21 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="renomeando-colunas" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="renomeando-colunas"><span class="header-section-number">5</span> Renomeando colunas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Fosforo_total =</span> P.total,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Captura_kg =</span> CPUE)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 11
   Reservatorio Bacia  Fechamento   Area Trofia    pH Condutividade Alcalinidade
   &lt;chr&gt;        &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
 1 Cavernoso    Iguacu       1965   2.9  Oligo…   7.4          33.1        140. 
 2 Curucaca     Iguacu       1982   2    Oligo…   7            32.4        126. 
 3 Foz do Areia Iguacu       1980 139    Oligo…   7.3          35.5         97  
 4 Irai         Iguacu       2000  15    EutrÃ…   6.9          50.2          3.3
 5 JMF          Iguacu       1970   0.45 Mesot…   7.3          40.2          3.7
 6 Jordao       Iguacu       1996   3.4  Oligo…   7.1          23.7        153. 
 7 Passauna     Iguacu       1978  14    Oligo…   8.8         126.         526  
 8 Piraquara    Iguacu       1979   3.3  Oligo…   7.1          22.8         50.7
 9 Salto Caxias Iguacu       1998 124    Oligo…   7.3          39.6        106  
10 Salto do Vau Iguacu       1959   2.9  Oligo…   6.5          23.2        279  
# ℹ 21 more rows
# ℹ 3 more variables: Fosforo_total &lt;dbl&gt;, Riqueza &lt;dbl&gt;, Captura_kg &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="agrupando-tabelas-funções-do-grupo-join" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="agrupando-tabelas-funções-do-grupo-join"><span class="header-section-number">6</span> Agrupando tabelas: funções do grupo <code>join</code></h2>
<p>As funções <code>left_join()</code>, <code>right_join()</code>, <code>inner_join()</code>, <code>anti_join()</code> e <code>full_join()</code> do pacote <code>dplyr</code> em R são utilizadas para combinar dois data frames baseados em uma coluna ou colunas comuns. Esses tipos de joins são amplamente utilizados em operações de banco de dados e manipulação de dados.</p>
<p>Considere os arquivos <code>regiao.csv</code> e <code>habitat.csv</code> do repositório <a href="https://github.com/FCopf/datasets">datasets</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>regiao <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/regiao.csv"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>habitat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/habitat.csv"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>regiao</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   Riacho Bacia      Município      Área
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt;
 1 R1     Boicucanga São Sebastião  30.3
 2 R4     Boicucanga São Sebastião  30.3
 3 R8     Boicucanga São Sebastião  30.3
 4 R2     Cubatão    Cubatão       189  
 5 R5     Cubatão    Cubatão       189  
 6 R10    Cubatão    Cubatão       189  
 7 R13    Cubatão    Cubatão       189  
 8 R6     Quilombo   Santos         86  
 9 R9     Quilombo   Santos         86  
10 R7     Quilombo   Santos         86  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>habitat</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  Riacho Altitude Largura Profundidade
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;
1 R1           74     7.8         20.2
2 R4           14    10.9         17.7
3 R8          245     8.3         19.5
4 R11         241     2.2         20.3
5 R2           29     1.6         11.8
6 R6           86    15.2         35.3
7 R9           77     4.1         18.9
8 R7           63    14.2         42.1</code></pre>
</div>
</div>
<p><strong>Tabela regiao</strong>: Contém informações sobre a bacia hidrográfica, área da bacia e município de alguns riachos da região litorânea de São Paulo.</p>
<p><strong>Tabela habitat</strong>: Contém informações sobre a largura e profundidade desses riachos. Algumas entradas são comuns às duas tabelas, enquanto outras são exclusivas de uma delas. A coluna <code>Riacho</code> serve como chave para combinar as informações.</p>
<section id="função-left_join" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="função-left_join">Função left_join()</h3>
<p>Retorna todas as linhas da tabela à esquerda (<code>regiao</code>) e adiciona colunas da tabela à direita (<code>habitat</code>). Linhas sem correspondência na tabela da direita terão valores de <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>regiao <span class="sc">|&gt;</span> <span class="fu">left_join</span>(<span class="at">y =</span> habitat)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
   Riacho Bacia      Município      Área Altitude Largura Profundidade
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;
 1 R1     Boicucanga São Sebastião  30.3       74     7.8         20.2
 2 R4     Boicucanga São Sebastião  30.3       14    10.9         17.7
 3 R8     Boicucanga São Sebastião  30.3      245     8.3         19.5
 4 R2     Cubatão    Cubatão       189         29     1.6         11.8
 5 R5     Cubatão    Cubatão       189         NA    NA           NA  
 6 R10    Cubatão    Cubatão       189         NA    NA           NA  
 7 R13    Cubatão    Cubatão       189         NA    NA           NA  
 8 R6     Quilombo   Santos         86         86    15.2         35.3
 9 R9     Quilombo   Santos         86         77     4.1         18.9
10 R7     Quilombo   Santos         86         63    14.2         42.1</code></pre>
</div>
</div>
</section>
<section id="função-right_join" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="função-right_join">Função right_join()</h3>
<p>Retorna todas as linhas da tabela à direita (<code>habitat</code>) e adiciona colunas da tabela à esquerda (<code>regiao</code>). Linhas sem correspondência na tabela da esquerda terão valores de <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>regiao <span class="sc">|&gt;</span> <span class="fu">right_join</span>(<span class="at">y =</span> habitat, <span class="at">keep=</span><span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  Riacho.x Bacia      Município      Área Riacho.y Altitude Largura Profundidade
  &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;
1 R1       Boicucanga São Sebastião  30.3 R1             74     7.8         20.2
2 R4       Boicucanga São Sebastião  30.3 R4             14    10.9         17.7
3 R8       Boicucanga São Sebastião  30.3 R8            245     8.3         19.5
4 R2       Cubatão    Cubatão       189   R2             29     1.6         11.8
5 R6       Quilombo   Santos         86   R6             86    15.2         35.3
6 R9       Quilombo   Santos         86   R9             77     4.1         18.9
7 R7       Quilombo   Santos         86   R7             63    14.2         42.1
8 &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;           NA   R11           241     2.2         20.3</code></pre>
</div>
</div>
</section>
<section id="função-inner_join" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="função-inner_join">Função inner_join()</h3>
<p>Retorna apenas as linhas que têm correspondência em ambas as tabelas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>regiao <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(<span class="at">y =</span> habitat)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 7
  Riacho Bacia      Município      Área Altitude Largura Profundidade
  &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;
1 R1     Boicucanga São Sebastião  30.3       74     7.8         20.2
2 R4     Boicucanga São Sebastião  30.3       14    10.9         17.7
3 R8     Boicucanga São Sebastião  30.3      245     8.3         19.5
4 R2     Cubatão    Cubatão       189         29     1.6         11.8
5 R6     Quilombo   Santos         86         86    15.2         35.3
6 R9     Quilombo   Santos         86         77     4.1         18.9
7 R7     Quilombo   Santos         86         63    14.2         42.1</code></pre>
</div>
</div>
</section>
<section id="função-anti_join" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="função-anti_join">Função anti_join()</h3>
<p>Retorna as linhas da tabela à esquerda que não têm correspondência na tabela à direita. Também retorna todas as colunas da tabela à esquerda.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>regiao <span class="sc">|&gt;</span> <span class="fu">anti_join</span>(<span class="at">y =</span> habitat)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Riacho Bacia   Município  Área
  &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;
1 R5     Cubatão Cubatão     189
2 R10    Cubatão Cubatão     189
3 R13    Cubatão Cubatão     189</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>habitat <span class="sc">|&gt;</span> <span class="fu">anti_join</span>(<span class="at">y =</span> regiao)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  Riacho Altitude Largura Profundidade
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;
1 R11         241     2.2         20.3</code></pre>
</div>
</div>
</section>
<section id="função-full_join" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="função-full_join">Função full_join()</h3>
<p>Retorna todas as linhas e colunas de ambas as tabelas. Nas células onde não houver correspondência, retorna <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>regiao <span class="sc">|&gt;</span> <span class="fu">full_join</span>(<span class="at">y =</span> habitat, <span class="at">keep =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 8
   Riacho.x Bacia      Município     Área Riacho.y Altitude Largura Profundidade
   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;
 1 R1       Boicucanga São Sebasti…  30.3 R1             74     7.8         20.2
 2 R4       Boicucanga São Sebasti…  30.3 R4             14    10.9         17.7
 3 R8       Boicucanga São Sebasti…  30.3 R8            245     8.3         19.5
 4 R2       Cubatão    Cubatão      189   R2             29     1.6         11.8
 5 R5       Cubatão    Cubatão      189   &lt;NA&gt;           NA    NA           NA  
 6 R10      Cubatão    Cubatão      189   &lt;NA&gt;           NA    NA           NA  
 7 R13      Cubatão    Cubatão      189   &lt;NA&gt;           NA    NA           NA  
 8 R6       Quilombo   Santos        86   R6             86    15.2         35.3
 9 R9       Quilombo   Santos        86   R9             77     4.1         18.9
10 R7       Quilombo   Santos        86   R7             63    14.2         42.1
11 &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;          NA   R11           241     2.2         20.3</code></pre>
</div>
</div>
</section>
</section>
<section id="criando-e-modificando-colunas-com-mutate" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="criando-e-modificando-colunas-com-mutate"><span class="header-section-number">7</span> Criando e modificando colunas com <code>mutate()</code></h2>
<p>A função <code>mutate()</code> permite criar e modificar colunas em um data frame. Usando a base de dados Doubs river:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(doubs)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>dbenv <span class="ot">&lt;-</span> doubs<span class="sc">$</span>env</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dbenv)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  dfs alt   slo flo pH har pho nit amm oxy bdo
1   3 934 6.176  84 79  45   1  20   0 122  27
2  22 932 3.434 100 80  40   2  20  10 103  19
3 102 914 3.638 180 83  52   5  22   5 105  35
4 185 854 3.497 253 80  72  10  21   0 110  13
5 215 849 3.178 264 81  84  38  52  20  80  62
6 324 846 3.497 286 79  60  20  15   0 102  53</code></pre>
</div>
</div>
<section id="ajustando-a-escala-de-ph" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ajustando-a-escala-de-ph">Ajustando a escala de pH</h3>
<p>A coluna <code>pH</code> está multiplicada por <span class="math inline">\(10\)</span>. Vamos ajustar isso:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>dbenv <span class="ot">&lt;-</span> dbenv  <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pH =</span> pH <span class="sc">/</span> <span class="dv">10</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dbenv)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  dfs alt   slo flo  pH har pho nit amm oxy bdo
1   3 934 6.176  84 7.9  45   1  20   0 122  27
2  22 932 3.434 100 8.0  40   2  20  10 103  19
3 102 914 3.638 180 8.3  52   5  22   5 105  35
4 185 854 3.497 253 8.0  72  10  21   0 110  13
5 215 849 3.178 264 8.1  84  38  52  20  80  62
6 324 846 3.497 286 7.9  60  20  15   0 102  53</code></pre>
</div>
</div>
</section>
<section id="criando-variável-categórica" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="criando-variável-categórica">Criando variável categórica</h3>
<p>Criar uma variável categórica <code>pH_cat</code> com níveis <code>Elevado</code> (maior ou igual a <span class="math inline">\(8\)</span>) e <code>Neutro</code> (menor que <span class="math inline">\(8\)</span>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>dbenv <span class="ot">&lt;-</span> dbenv <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pH =</span> pH <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pH_cat =</span> <span class="fu">if_else</span>(pH <span class="sc">&lt;</span> <span class="dv">8</span>, <span class="at">true =</span> <span class="st">"Neutro"</span>, <span class="at">false =</span> <span class="st">"Elevado"</span>),</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>         , <span class="at">.after =</span> pH)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dbenv)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  dfs alt   slo flo   pH pH_cat har pho nit amm oxy bdo
1   3 934 6.176  84 0.79 Neutro  45   1  20   0 122  27
2  22 932 3.434 100 0.80 Neutro  40   2  20  10 103  19
3 102 914 3.638 180 0.83 Neutro  52   5  22   5 105  35
4 185 854 3.497 253 0.80 Neutro  72  10  21   0 110  13
5 215 849 3.178 264 0.81 Neutro  84  38  52  20  80  62
6 324 846 3.497 286 0.79 Neutro  60  20  15   0 102  53</code></pre>
</div>
</div>
</section>
<section id="unindo-colunas-com-unite" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="unindo-colunas-com-unite">Unindo colunas com <code>unite()</code></h3>
<p>A função <code>unite()</code> do <code>tidyr</code> combina duas colunas em uma nova coluna. Usando a tabela <code>iris</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Genus =</span> <span class="st">"Iris"</span>, <span class="at">.before =</span> Species)  <span class="sc">|&gt;</span>  </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(scientic_name, Genus, Species, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width scientic_name
1          5.1         3.5          1.4         0.2   Iris setosa
2          4.9         3.0          1.4         0.2   Iris setosa
3          4.7         3.2          1.3         0.2   Iris setosa
4          4.6         3.1          1.5         0.2   Iris setosa
5          5.0         3.6          1.4         0.2   Iris setosa
6          5.4         3.9          1.7         0.4   Iris setosa</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observação
</div>
</div>
<div class="callout-body-container callout-body">
<p>A função <code>unite()</code> excluiu as colunas que foram unificadas da tabela. Mara mantê-las na tabela utilize o argumento <code>remove = FALSE</code>.</p>
</div>
</div>
</section>
</section>
<section id="reformatando-data-frames-funções-pivot_wider-e-pivot_longer" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="reformatando-data-frames-funções-pivot_wider-e-pivot_longer"><span class="header-section-number">8</span> Reformatando data frames: funções <code>pivot_wider()</code> e <code>pivot_longer()</code></h2>
<p>A tabela <code>HubbardBrook.csv</code> (<a href="https://github.com/FCopf/datasets">datasets</a>) contém dados anuais de vazão e precipitação em dois bacias hidrográficas <span class="citation" data-cites="hornbeck1993long">(<a href="#ref-hornbeck1993long" role="doc-biblioref">Hornbeck et al. 1993</a>)</span>. A primeira (<code>Deforested</code>) teve toda a vegetação removida como parte de um experimento de longa duração enquanto a outra se manteve intacta (<code>Referenca</code>). Os daods de origem e o experimento detalhado são apresentados am Os dados foram retirados de <a href="https://tiee.esa.org/vol/v1/data_sets/hubbard/hubbard_overview.html">tiee.esa.org</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>hbrook <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/HubbardBrook.csv"</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>hbrook</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 62 × 4
    Year Treatment   Flow Precipitation
   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;         &lt;dbl&gt;
 1  1958 Deforested  645.         1168.
 2  1959 Deforested 1012.         1483.
 3  1960 Deforested  825.         1321.
 4  1961 Deforested  470.          980.
 5  1962 Deforested  777.         1232.
 6  1963 Deforested  774.         1139.
 7  1964 Deforested  712.         1175.
 8  1965 Deforested  599.         1115.
 9  1966 Deforested 1189.         1222.
10  1967 Deforested 1132.         1315.
# ℹ 52 more rows</code></pre>
</div>
</div>
<section id="reorganizando-data-frames-de-formato-longo-para-formato-largo" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="reorganizando-data-frames-de-formato-longo-para-formato-largo">Reorganizando data frames de formato longo para formato largo</h3>
<p>A função <code>pivot_wider()</code> é utilizada para transformar dados do formato longo para o formato largo. A seguir, será feito isso apenas para a variável <code>Flow</code>, excluindo <code>Precipitation</code>, separando os dados nas colunas <code>Deforested</code> e <code>Reference</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>hbrook_largo <span class="ot">&lt;-</span> hbrook <span class="sc">|&gt;</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Precipitation) <span class="sc">|&gt;</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Treatment, <span class="at">values_from =</span> Flow)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>hbrook_largo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 3
    Year Deforested Reference
   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1  1958       645.      567.
 2  1959      1012.      918.
 3  1960       825.      752.
 4  1961       470.      436.
 5  1962       777.      699.
 6  1963       774.      663.
 7  1964       712.      630.
 8  1965       599.      547.
 9  1966      1189.      727.
10  1967      1132.      781.
# ℹ 21 more rows</code></pre>
</div>
</div>
</section>
<section id="reorganizando-data-frames-de-formato-largo-para-formato-longo" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="reorganizando-data-frames-de-formato-largo-para-formato-longo">Reorganizando data frames de formato largo para formato longo</h3>
<p>A função <code>pivot_longer()</code> é utilizada para transformar dados do formato largo para o formato longo, fazendo o caminho inverso de <code>pivot_wider()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>hbrook_longo <span class="ot">&lt;-</span> hbrook_largo <span class="sc">|&gt;</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>Year, <span class="at">names_to =</span> <span class="st">"Desmatamento"</span>, <span class="at">values_to =</span> <span class="st">"Flow"</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>hbrook_longo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 62 × 3
    Year Desmatamento  Flow
   &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;
 1  1958 Deforested    645.
 2  1958 Reference     567.
 3  1959 Deforested   1012.
 4  1959 Reference     918.
 5  1960 Deforested    825.
 6  1960 Reference     752.
 7  1961 Deforested    470.
 8  1961 Reference     436.
 9  1962 Deforested    777.
10  1962 Reference     699.
# ℹ 52 more rows</code></pre>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Referências</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-hornbeck1993long" class="csl-entry" role="listitem">
Hornbeck, J. W., M. B. Adams, E. S. Corbett, E. S. Verry, e J. A. Lynch. 1993. <span>«Long-term impacts of forest treatment on water yield: a summary for northeastern USA»</span>. <em>Journal of Hydrology</em> 150: 323–44.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/github\.com\/FCopf\/MEAD");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>