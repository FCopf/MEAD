{
  "hash": "88ec275c51b4242f158a3ae5aa2e5c12",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"O modelo da distribuição normal\"  \nsubtitle: \"Função de densidade e função de probabilidade acumulada\"  \ndescription: \"Explora a distribuição normal para extrair probabilidades\"\nCategories: [\n          \"Distribuição normal\",\n          \"Função de densidade\",\n          \"Função de probabilidade acumulada\"\n        ]\n\nimage: \"images/distribuicao_normal-probabilidade.png\"\nexecute:  \n  echo: true  \n  warning: false  \n  include: true  \n  message: false  \n\n---\n\n\n\n\n\n::: {.callout-tip title=\"Bibliotecas utilizadas nesta seção\" collapse=\"true\"}\n\n::: {#42c7bf6d .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.stats as st\n```\n:::\n\n\n:::\n\n![Histograma das alturas de alunos da Escola de Agricultura de Connecticut [@blakeslee1914corn]. $n = 175$ alunos com média $\\overline{Y} = 170,94$ cm e desvio padrão $s = 6,86$. Retirado de @crow1997birth.\"](images/Blakeslee_1914-alturas.png){#fig-alturas_crow1997}\n\n## Simulando uma distribuição de probabilidade normal\n\nVamos utilizar nosso modelo teórico de probabilidades (a distribuição normal) para prever o que seria esperado para as frequências relativas de alunos de\ndiferentes alturas. Para isso precisamos calcular a probabilidade abaixo da curva para diferentes faixas de altura.\n\nEstritamente falando a equação da distribuição normal abaixo:\n\n$$\nf(x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} e^{-\\frac{1}{2} \\left(\\frac{x - \\mu}{\\sigma} \\right)^2}, \\quad x \\in \\mathbb{R} \\mid -\\infty \\leq x \\leq +\\infty\n$$\n\né a **Função de Densidade de Probabilidade (PDF)** da distribuição normal. Com base nesta equação, as probabilidades para intervalos de $X$ são obtidas por meio da Função de **Probabilidade Acumulada (CDF)**.\n\n::: {#a6475ec4 .cell execution_count=2}\n``` {.python .cell-code}\nmi = 170.94\nsigma = 6.86\n\nx = np.linspace(130, 210, 1000)\npdf = st.norm.pdf(x = x, loc = mi, scale = sigma)\n\ncdf = st.norm.cdf(x = x, loc = mi, scale = sigma)\n\n```\n:::\n\n\nA distribuição normal com média $X = 170.94$ e $\\sigma = 6.86$ estão representadas abaixo (PDF - @fig-normal-pdf-cdf-1; CDF - @fig-normal-pdf-cdf-2).\n\n::: {#fig-normal-pdf-cdf .cell layout-ncol='2' execution_count=3}\n``` {.python .cell-code}\nplt.plot(x, pdf)\nplt.xlabel('Alturas (cm)')\nplt.ylabel('PDF')\nplt.show()\n\nplt.plot(x, cdf)\nplt.xlabel('Alturas (cm)')\nplt.ylabel('CDF')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Função de Densidade de Probabilidade (PDF)](distribuicao_normal-probabilidade_files/figure-html/fig-normal-pdf-cdf-output-1.png){#fig-normal-pdf-cdf-1 width=597 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n![Função de Probabilidade Acumulada (CDF).](distribuicao_normal-probabilidade_files/figure-html/fig-normal-pdf-cdf-output-2.png){#fig-normal-pdf-cdf-2 width=589 height=429}\n:::\n\nDistribuição normal de probabilidade\n:::\n\n\n## Obtendo probabilidades de uma distribuição normal\n\n### A probabilidade de $X$ ser **menor** ou igual a $x_1$: $P(X \\le x_1)$\n\n::: {#fig-normal-prob-abaixo .cell layout-ncol='2' execution_count=4}\n``` {.python .cell-code}\nmi = 170.94\nsigma = 6.86\nx1 = 160\n\nx = np.linspace(130, 210, 1000)\n\npdf_y = st.norm.pdf(x = x, loc = mi, scale = sigma)\ncdf_y = st.norm.cdf(x = x, loc = mi, scale = sigma)\np = st.norm.cdf(x = x1, loc=mi, scale=sigma)\n\nplt.plot(x, pdf_y)\nplt.fill_between(x, pdf_y, where = (x <= x1), color='lightblue')\nplt.title(f'$P(X \\leq {x1})$ = {np.round(p, 3)}')\nplt.show()\n\nplt.plot(x, cdf_y)\nplt.yticks(np.arange(0, 1.1, 0.1))\nplt.title(f'$F(X = {x1}$) = {np.round(p, 3)}')\nplt.plot([x1, x1], [0, p], color = 'red', linewidth = 3)\nplt.plot([130, x1], [p, p], color = 'red', linewidth = 3)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Função de Densidade de Probabilidade (PDF)](distribuicao_normal-probabilidade_files/figure-html/fig-normal-prob-abaixo-output-1.png){#fig-normal-prob-abaixo-1 width=579 height=432}\n:::\n\n::: {.cell-output .cell-output-display}\n![Função de Probabilidade Acumulada (CDF).](distribuicao_normal-probabilidade_files/figure-html/fig-normal-prob-abaixo-output-2.png){#fig-normal-prob-abaixo-2 width=571 height=432}\n:::\n\nDistribuição Normal de Probabilidades.\n:::\n\n\n### A probabilidade de $X$ ser **maior** ou igual a $x_1$: $P(X \\ge x_1)$\n\n::: {#fig-normal-prob-acima .cell layout-ncol='2' execution_count=5}\n``` {.python .cell-code}\nmi = 170.94\nsigma = 6.86\nx1 = 180\n\nx = np.linspace(130, 210, 1000)\n\npdf_y = st.norm.pdf(x = x, loc = mi, scale = sigma)\ncdf_y = st.norm.cdf(x = x, loc = mi, scale = sigma)\np = st.norm.cdf(x = x1, loc=mi, scale=sigma)\n\nplt.plot(x, pdf_y)\nplt.fill_between(x, pdf_y, where = (x >= x1), color='lightblue')\nplt.title(f'$P(X \\geq {x1})$ = {np.round(p, 3)}')\nplt.show()\n\nplt.plot(x, cdf_y)\nplt.yticks(np.arange(0, 1.1, 0.1))\nplt.title(f'$F(X = {x1}$) = {np.round(p, 3)}')\nplt.plot([x1, x1], [0, p], color = 'red', linewidth = 3)\nplt.plot([130, x1], [p, p], color = 'red', linewidth = 3)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Função de Densidade de Probabilidade (PDF)](distribuicao_normal-probabilidade_files/figure-html/fig-normal-prob-acima-output-1.png){#fig-normal-prob-acima-1 width=579 height=432}\n:::\n\n::: {.cell-output .cell-output-display}\n![Função de Probabilidade Acumulada (CDF).](distribuicao_normal-probabilidade_files/figure-html/fig-normal-prob-acima-output-2.png){#fig-normal-prob-acima-2 width=571 height=432}\n:::\n\nDistribuição Normal de Probabilidades.\n:::\n\n\n### A probabilidade de $X$ estar **entre** $x_1$ e $x_2$: $P(x_1 \\le X \\le x_2)$\n\n::: {#fig-normal-prob-entre .cell layout-ncol='2' execution_count=6}\n``` {.python .cell-code}\nmi = 170.94\nsigma = 6.86\nx1 = 160\nx2 = 180\n\nx = np.linspace(130, 210, 1000)\n\npdf_y = st.norm.pdf(x = x, loc = mi, scale = sigma)\ncdf_y = st.norm.cdf(x = x, loc = mi, scale = sigma)\np1 = st.norm.cdf(x = x1, loc=mi, scale=sigma)\np2 = st.norm.cdf(x = x2, loc=mi, scale=sigma)\np = p2 - p1\n\nplt.plot(x, pdf_y)\nplt.fill_between(x, pdf_y, where = ((x >= x1) & (x <= x2)), color='lightblue')\nplt.title(f'$P({x1} \\leq X \\leq {x2})$ = {np.round(p, 3)}')\nplt.show()\n\nplt.plot(x, cdf_y)\nplt.yticks(np.arange(0, 1.1, 0.1))\nplt.title(f'$F(X = {x1}$) = {np.round(p, 3)}')\nplt.title(f'$F(X = {x2}$) = {np.round(p, 3)}')\nplt.plot([x1, x1], [0, p1], color = 'red', linewidth = 3)\nplt.plot([130, x1], [p1, p1], color = 'red', linewidth = 3)\nplt.plot([x2, x2], [0, p2], color = 'red', linewidth = 3)\nplt.plot([130, x2], [p2, p2], color = 'red', linewidth = 3)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Função de Densidade de Probabilidade (PDF)](distribuicao_normal-probabilidade_files/figure-html/fig-normal-prob-entre-output-1.png){#fig-normal-prob-entre-1 width=579 height=432}\n:::\n\n::: {.cell-output .cell-output-display}\n![Função de Probabilidade Acumulada (CDF).](distribuicao_normal-probabilidade_files/figure-html/fig-normal-prob-entre-output-2.png){#fig-normal-prob-entre-2 width=571 height=432}\n:::\n\nDistribuição Normal de Probabilidades.\n:::\n\n\n### Representando $x_1$ e $x_2$ por $\\mu \\pm z\\sigma$: $P(\\mu - z\\sigma \\le X \\le \\mu + z\\sigma)$\n\nObs.: $z$ representa o **número de desvios padrões** acima ou abaixo de $\\mu$.\n\n::: {#cell-fig-normal-prob-z .cell execution_count=7}\n``` {.python .cell-code}\nmi = 170.94\nsigma = 6.86\nz = 1.96\nx1 = mi - z * sigma\nx2 = mi + z * sigma\n\nx = np.arange(130, 210, 0.001)\ny = st.norm.pdf(x = x, loc = mi, scale = sigma)\n\np1 = st.norm.cdf(x = x1, loc=mi, scale=sigma)\np2 = st.norm.cdf(x = x2, loc=mi, scale=sigma)\np = p2 - p1\n\nplt.plot(x, y)\nplt.fill_between(x, y, where = ((x >= x1) & (x <= x2)), color='lightblue')\nplt.title(f'P($\\mu - {z}\\sigma \\leq X \\leq \\mu + {z}\\sigma$) = {np.round(p, 3)}')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Distribuição Normal de Probabilidades.](distribuicao_normal-probabilidade_files/figure-html/fig-normal-prob-z-output-1.png){#fig-normal-prob-z width=579 height=432}\n:::\n:::\n\n\n",
    "supporting": [
      "distribuicao_normal-probabilidade_files"
    ],
    "filters": [],
    "includes": {}
  }
}