{
  "hash": "446a37e611d9bbe0d114672be37b35a6",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Modelos Estatísticos e Modelos Científicos\"\nsubtitle: \"Complexidade Tecnológica em Ilhas da Oceania\"\ndescription: \"Como o tamanho das populações e o contato entre sociedades influenciaram a complexidade das ferramentas tradicionais\"\nCategories: [\n        \"GLM\",\n        \"Regressão linear\",\n        \"Modelo não linear\",\n        \"Regressão de Poisson\"\n        ]\nimage: \"images/regressao-linear-bayesiana.png\"\nexecute:\n    echo: true\n    eval: true\n    warning: false\n    message: false\n\n---\n\n\n---\n\nVamos utilizar modelos estatísticos para analisar a **complexidade tecnológica tradicional em ilhas da Oceania** [@kline2010population]. Nosso objetivo é compreender como o **tamanho populacional** e a **intensidade de contato entre sociedades** influenciaram o **número de ferramentas** (e sua complexidade, medida em *unidades tecnológicas*). Iniciaremos essa investigação com **modelos estatísticos simples**, progredindo para **Modelos Lineares Generalizados (GLMs)**, com especial atenção à **regressão de Poisson**, que é particularmente adequada para dados de contagem como o número de ferramentas. Posteriormente, exploraremos a construção de um **modelo científico (mecanicista)** baseado em uma descrição da dinâmica de aquisição e perda de ferramentas por uma sociedade conforme apresentado por @mcelreath2018statistical.\n\nInicialmente, vamos avaliar o conjunto de dados [kline.csv](https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/kline.csv).\n\n::: {#51e080a1 .cell execution_count=1}\n``` {.python .cell-code}\nimport pymc as pm\nimport bambi as bmb\nimport arviz as az\nimport pandas as pd\nimport numpy as np\nfrom plotnine import *\nimport plotly.express as px\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n```\n:::\n\n\n::: {#62f36e9a .cell execution_count=2}\n``` {.python .cell-code}\nkline = pd.read_csv('https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/kline.csv')\nkline\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>culture</th>\n      <th>population</th>\n      <th>contact</th>\n      <th>total_tools</th>\n      <th>mean_TU</th>\n      <th>lat</th>\n      <th>lon</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Malekula</td>\n      <td>1100</td>\n      <td>low</td>\n      <td>13</td>\n      <td>3.2</td>\n      <td>-16.3</td>\n      <td>167.5</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Tikopia</td>\n      <td>1500</td>\n      <td>low</td>\n      <td>22</td>\n      <td>4.7</td>\n      <td>-12.3</td>\n      <td>168.8</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Santa Cruz</td>\n      <td>3600</td>\n      <td>low</td>\n      <td>24</td>\n      <td>4.0</td>\n      <td>-10.7</td>\n      <td>166.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Yap</td>\n      <td>4791</td>\n      <td>high</td>\n      <td>43</td>\n      <td>5.0</td>\n      <td>9.5</td>\n      <td>138.1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Lau Fiji</td>\n      <td>7400</td>\n      <td>high</td>\n      <td>33</td>\n      <td>5.0</td>\n      <td>-17.7</td>\n      <td>178.1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Trobriand</td>\n      <td>8000</td>\n      <td>high</td>\n      <td>19</td>\n      <td>4.0</td>\n      <td>-8.7</td>\n      <td>150.9</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Chuuk</td>\n      <td>9200</td>\n      <td>high</td>\n      <td>40</td>\n      <td>3.8</td>\n      <td>7.4</td>\n      <td>151.6</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Manus</td>\n      <td>13000</td>\n      <td>low</td>\n      <td>28</td>\n      <td>6.6</td>\n      <td>-2.1</td>\n      <td>146.9</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Tonga</td>\n      <td>17500</td>\n      <td>high</td>\n      <td>55</td>\n      <td>5.4</td>\n      <td>-21.2</td>\n      <td>-175.2</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Hawaii</td>\n      <td>275000</td>\n      <td>low</td>\n      <td>71</td>\n      <td>6.6</td>\n      <td>19.9</td>\n      <td>-155.6</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nE visualizar a relação entre tamanho populacional (P), intensidade de contato e número total de ferramentas (T). \n\n::: {#cell-fig-tools-pop .cell .fig-cap-location-bottom execution_count=3}\n``` {.python .cell-code}\n(\n    ggplot(kline, aes(x='population', y='total_tools', color='contact')) +\n       geom_point(size=5, alpha=0.7) +\n       scale_color_manual(values={'high': '#1f77b4', 'low': '#ff7f0e'}) +\n       labs(x='Tamanho populacional', \n            y='Número total de ferramentas',\n            color='Intensidade de contato') +\n        theme(legend_position = 'top')\n)\n```\n\n::: {.cell-output .cell-output-display}\n![Relação entre o número total de ferramentas e o tamanho populacional em ilhas na Oceania](regressao-poisson_files/figure-html/fig-tools-pop-output-1.png){#fig-tools-pop width=672 height=480}\n:::\n:::\n\n\n## Regressão linear: transformação logarítmica\n\nA relação na @fig-tools-pop é claramente não linear e pode ser descrita por\n\n$$T = \\beta_0P^{\\beta_1}$$\n\nUm alterativa simples neste caso, é utilizar uma transformação logarítmica para *linearizar* a expressão:\n\n$$log(T) = log(\\beta_0P^{\\beta_1}) \\Rightarrow log(T) = log(\\beta_0) + log(P^{\\beta_1}) \\Rightarrow$$\n\n$$log(T) = B_0 + \\beta_1 log(P)\n$${#eq-logT-logP}\n\nem que $\\textit{B}_0 = log(\\beta_0)$\n\nO que resulta na abaixo:\n\n::: {#cell-fig-log-tools-pop .cell .fig-cap-location-bottom execution_count=4}\n``` {.python .cell-code}\n(\n    ggplot(kline, aes(x='population', y='total_tools', color='contact')) +\n       geom_point(size=5, alpha=0.7) +\n       scale_color_manual(values={'high': '#1f77b4', 'low': '#ff7f0e'}) +\n       scale_y_continuous(trans='log') +\n       scale_x_continuous(trans='log') +\n       labs(x='Tamanho populacional (escala log)', \n            y='Número total de ferramentas (escala log)',\n            color='Intensidade de contato') +\n        theme(legend_position = 'top')\n)\n```\n\n::: {.cell-output .cell-output-display}\n![Relação entre o logarítmo do número total de ferramentas e o logarítmo do tamanho populacional em ilhas na Oceania](regressao-poisson_files/figure-html/fig-log-tools-pop-output-1.png){#fig-log-tools-pop width=672 height=480}\n:::\n:::\n\n\nConsiderando que a relação na @fig-log-tools-pop é aproximadamente linear, vamos ajustar o modelo de regressão linear descrito na @eq-logT-logP.\n\nNeste modelo, estamos assumindo que:\n\n$$log(T) ~ \\sim \\mathcal{N}(\\mu,\\,\\sigma)$$\n\n$$\\mu = B_0 + \\beta_1 log(P)$$\n\n::: {#7c7af093 .cell execution_count=5}\n``` {.python .cell-code}\nkline['log_tools'] = np.log(kline['total_tools'])\nkline['log_pop'] = np.log(kline['population'])\n\nrl = bmb.Model('log_tools ~ log_pop', data=kline)\n\n# Amostragem posterior\nrl_fit = rl.fit(draws=2000, tune=1000)\n\n# Resumo dos parâmetros\naz.summary(rl_fit)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"545c6716925f4b52b3cd4645e824d23b\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=26}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>mean</th>\n      <th>sd</th>\n      <th>hdi_3%</th>\n      <th>hdi_97%</th>\n      <th>mcse_mean</th>\n      <th>mcse_sd</th>\n      <th>ess_bulk</th>\n      <th>ess_tail</th>\n      <th>r_hat</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>sigma</th>\n      <td>0.365</td>\n      <td>0.102</td>\n      <td>0.204</td>\n      <td>0.555</td>\n      <td>0.002</td>\n      <td>0.002</td>\n      <td>4293.0</td>\n      <td>4841.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>Intercept</th>\n      <td>1.028</td>\n      <td>0.746</td>\n      <td>-0.363</td>\n      <td>2.471</td>\n      <td>0.010</td>\n      <td>0.012</td>\n      <td>6131.0</td>\n      <td>4770.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>log_pop</th>\n      <td>0.268</td>\n      <td>0.082</td>\n      <td>0.113</td>\n      <td>0.425</td>\n      <td>0.001</td>\n      <td>0.001</td>\n      <td>6117.0</td>\n      <td>4648.0</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nExtraindo amostras da posterior para construir a *reta média*\n\n::: {#570bcfd5 .cell execution_count=6}\n``` {.python .cell-code}\nrl_post = rl_fit.posterior\nbeta_0 = rl_post['Intercept'].mean().item()\nbeta_1 = rl_post['log_pop'].mean().item()\n\n# Gera reta de predição\nx_vals = np.linspace(kline['log_pop'].min(), kline['log_pop'].max(), 100)\ny_vals = beta_0 + beta_1 * x_vals\n```\n:::\n\n\n::: {#1b0f3ef3 .cell execution_count=7}\n``` {.python .cell-code}\n# Plotando o resultado\nplt.figure(figsize=(8, 6))\n\nsns.scatterplot(data=kline, x='log_pop', y='log_tools',\n    hue='contact', palette={'high': '#1f77b4', 'low': '#ff7f0e'}, s=150, alpha=0.7)\n\n# Adicionando as retas de predição\nplt.plot(x_vals, y_vals, color='#ff0e0e', linestyle='-', linewidth=3, label='Predição')\n\nplt.xlabel('log(Tamanho populacional)', fontsize=14)\nplt.ylabel('log(Número total de ferramentas)', fontsize=14)\nplt.xticks(fontsize=12)\nplt.yticks(fontsize=12)\nplt.legend()\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/cell-8-output-1.png){width=758 height=566}\n:::\n:::\n\n\nA reta parece se ajustar bem ao pontos. Vamos agora incluir no modelo o efeito da intensidade de contato.\n\n::: {#ac3ad05e .cell execution_count=8}\n``` {.python .cell-code}\nrli = bmb.Model('log_tools ~ log_pop * contact', data=kline)\n\n# Amostragem posterior\nrli_fit = rli.fit(draws=2000, tune=1000)\n\n# Resumo dos parâmetros\naz.summary(rli_fit)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"82365e7566f34b93819a4a241f47c31b\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=29}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>mean</th>\n      <th>sd</th>\n      <th>hdi_3%</th>\n      <th>hdi_97%</th>\n      <th>mcse_mean</th>\n      <th>mcse_sd</th>\n      <th>ess_bulk</th>\n      <th>ess_tail</th>\n      <th>r_hat</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>sigma</th>\n      <td>0.364</td>\n      <td>0.108</td>\n      <td>0.201</td>\n      <td>0.560</td>\n      <td>0.002</td>\n      <td>0.002</td>\n      <td>1448.0</td>\n      <td>768.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>Intercept</th>\n      <td>1.156</td>\n      <td>1.595</td>\n      <td>-1.903</td>\n      <td>4.080</td>\n      <td>0.034</td>\n      <td>0.024</td>\n      <td>2140.0</td>\n      <td>2928.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>log_pop</th>\n      <td>0.268</td>\n      <td>0.176</td>\n      <td>-0.070</td>\n      <td>0.592</td>\n      <td>0.004</td>\n      <td>0.003</td>\n      <td>2120.0</td>\n      <td>3005.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>contact[low]</th>\n      <td>-0.209</td>\n      <td>1.487</td>\n      <td>-3.000</td>\n      <td>2.567</td>\n      <td>0.034</td>\n      <td>0.023</td>\n      <td>1913.0</td>\n      <td>2749.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>log_pop:contact[low]</th>\n      <td>-0.005</td>\n      <td>0.164</td>\n      <td>-0.318</td>\n      <td>0.295</td>\n      <td>0.004</td>\n      <td>0.002</td>\n      <td>1908.0</td>\n      <td>2781.0</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nE plotar as retas médias com seus intervalos de credibilidade.\n\n::: {#3a89746e .cell execution_count=9}\n``` {.python .cell-code}\nrli_post = rli_fit.posterior\nbeta_0_samples = rli_post['Intercept'].values.flatten()\nbeta_1_samples = rli_post['log_pop'].values.flatten()\nbeta_2_samples = rli_post['contact'].values.flatten()\nbeta_3_samples = rli_post['log_pop:contact'].values.flatten()\n```\n:::\n\n\n::: {#cda0f3cc .cell execution_count=10}\n``` {.python .cell-code}\n# Gera valores de x para predição\nx_vals = np.linspace(kline['log_pop'].min(), kline['log_pop'].max(), 100)\n\n# Calcula predições para todas as amostras\nn_samples = len(beta_0_samples)\npredictions_high = np.zeros((n_samples, len(x_vals)))\npredictions_low = np.zeros((n_samples, len(x_vals)))\n\nfor i in range(n_samples):\n    # Para contato 'high' (categoria de referência)\n    predictions_high[i] = beta_0_samples[i] + beta_1_samples[i] * x_vals\n    \n    # Para contato 'low'\n    predictions_low[i] = (beta_0_samples[i] + beta_2_samples[i]) + (beta_1_samples[i] + beta_3_samples[i]) * x_vals\n```\n:::\n\n\n::: {#f716ee25 .cell execution_count=11}\n``` {.python .cell-code}\n# Calcula médias e intervalos de credibilidade\nmean_high = np.mean(predictions_high, axis=0)\nmean_low = np.mean(predictions_low, axis=0)\n\n# Intervalos de credibilidade de 95%\nhdi_high = az.hdi(predictions_high, hdi_prob=0.95)\nhdi_low = az.hdi(predictions_low, hdi_prob=0.95)\n```\n:::\n\n\n::: {#161b169b .cell execution_count=12}\n``` {.python .cell-code}\n# Plotando o resultado\nplt.figure(figsize=(8, 6))\n\n# Scatter plot dos dados\nsns.scatterplot(data=kline, x='log_pop', y='log_tools',\n    hue='contact', palette={'high': '#1f77b4', 'low': '#ff7f0e'}, s=150, alpha=0.8)\n\n# Bandas de credibilidade\nplt.fill_between(x_vals, hdi_high[:, 0], hdi_high[:, 1], \n                 color='#1f77b4', alpha=0.2, label='95% HDI (high contact)')\nplt.fill_between(x_vals, hdi_low[:, 0], hdi_low[:, 1], \n                 color='#ff7f0e', alpha=0.2, label='95% HDI (low contact)')\n\n# Retas de predição (médias)\nplt.plot(x_vals, mean_high, color='#1f77b4', linestyle='-', linewidth=3, \n         label='Média posterior (high contact)')\nplt.plot(x_vals, mean_low, color='#ff7f0e', linestyle='-', linewidth=3, \n         label='Média posterior (low contact)')\n\nplt.xlabel('log(Tamanho populacional)', fontsize=14)\nplt.ylabel('log(Número total de ferramentas)', fontsize=14)\nplt.xticks(fontsize=12)\nplt.yticks(fontsize=12)\nplt.legend(loc='lower right', fontsize=10)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/cell-13-output-1.png){width=758 height=566}\n:::\n:::\n\n\nComo a regressão foi feita na escala logarítmica precisamos retornar à escala original para verificar os valores preditos.\n\n::: {#f6ad94f1 .cell execution_count=13}\n``` {.python .cell-code}\nx_vals_or = np.exp(x_vals)\nhdi_high_or = np.exp(hdi_high)\nhdi_low_or = np.exp(hdi_low)\nmean_high_or = np.exp(mean_high)\nmean_low_or = np.exp(mean_low)\n```\n:::\n\n\n::: {#5a72a120 .cell execution_count=14}\n``` {.python .cell-code}\n# Plotando o resultado\nplt.figure(figsize=(8, 6))\n\n# Scatter plot dos dados\nsns.scatterplot(data=kline, x='population', y='total_tools',\n    hue='contact', palette={'high': '#1f77b4', 'low': '#ff7f0e'}, s=150, alpha=0.8)\n\n# Bandas de credibilidade\nplt.fill_between(x_vals_or, hdi_high_or[:, 0], hdi_high_or[:, 1], \n                 color='#1f77b4', alpha=0.2, label='95% HDI (high contact)')\nplt.fill_between(x_vals_or, hdi_low_or[:, 0], hdi_low_or[:, 1], \n                 color='#ff7f0e', alpha=0.2, label='95% HDI (low contact)')\n\n# Retas de predição (médias)\nplt.plot(x_vals_or, mean_high_or, color='#1f77b4', linestyle='-', linewidth=3, \n         label='Média posterior (high contact)')\nplt.plot(x_vals_or, mean_low_or, color='#ff7f0e', linestyle='-', linewidth=3, \n         label='Média posterior (low contact)')\n\nplt.xlabel('Tamanho populacional', fontsize=14)\nplt.ylabel('Número total de ferramentas', fontsize=14)\nplt.xticks(fontsize=12)\nplt.yticks(fontsize=12)\nplt.legend(loc='upper left', fontsize=10)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/cell-15-output-1.png){width=758 height=566}\n:::\n:::\n\n\n## Regressão de Poisson: dados de contagem\n\nEmbora a transformação logarítmica torne linear a porção determinística do modelo, ela não resolve adequadamente a natureza discreta da variável de resposta. No caso do número de ferramentas (`total_tools`), estamos lidando com dados de contagem — valores inteiros não negativos. Uma abordagem mais apropriada é utilizar uma **regressão de Poisson**, que modela diretamente a distribuição da variável como uma variável aleatória de contagem.\n\nNeste contexto, vamos explorar a hipótese de que o número de ferramentas disponíveis em uma sociedade depende de três fatores:\n\n1. **O tamanho populacional (em escala logarítmica):**\n   O que realmente influencia a diversidade tecnológica não é o tamanho absoluto da população, mas sim sua **ordem de grandeza** [@kline2010population]. Espera-se, portanto, uma associação positiva entre o número de ferramentas e o logaritmo do tamanho populacional.\n\n2. **A taxa de contato entre as ilhas:**\n   Ilhas com maior conectividade social e cultural tendem a manter ou adquirir mais tipos de ferramentas. Assim, espera-se um efeito positivo do nível de contato.\n\n3. **Interação entre população e contato:**\n   O efeito da população pode depender do nível de contato: em contextos mais conectados, o impacto do tamanho populacional sobre a diversidade de ferramentas pode ser mais pronunciado. Vamos representar essa moderação por meio de um **termo de interação entre `log(população)` e `contato`**.\n\nCom base nessas hipóteses, ajustaremos um modelo de regressão de Poisson no qual a expectativa do número de ferramentas é uma função log-linear desses três componentes.\n\nO modelo generativo pode ser descrito como:\n\n$$\nT_i \\sim \\text{Poisson}(\\lambda_i)\n$$\n\n$$\n\\log(\\lambda_i) = \\beta_0 + \\beta_1 \\cdot \\log(P_i) + \\beta_2 \\cdot C_i + \\beta_3 \\cdot \\log(P_i) \\cdot C_i\n$$\n\nOnde:\n\n* $T_i$ é o número de ferramentas na sociedade *i*;\n* $P_i$ é o tamanho populacional;\n* $C_i$ representa o nível de contato (por exemplo, *high* ou *low*);\n* A interação $\\log(P_i) \\cdot C_i$ permite que o efeito de $\\log(P_i)$ varie conforme o nível de contato.\n\n### Ajustando o modelo com `bambi`\n\n::: {#3ac49088 .cell execution_count=15}\n``` {.python .cell-code}\npriors_rp={\n        \"Intercept\": bmb.Prior(\"Normal\", mu=3, sigma=0.5),\n        \"log_pop\": bmb.Prior(\"Normal\", mu=0, sigma=1),\n        \"contact\": bmb.Prior(\"Normal\", mu=0, sigma=1),\n        \"log_pop:contact\": bmb.Prior(\"Normal\", mu=0, sigma=1)\n    }\n\nrpois = bmb.Model(\n    \"total_tools ~ log_pop * contact\",\n    family=\"poisson\",\n    data=kline,\n    priors=priors_rp\n)\n\nrpois_fit = rpois.fit(draws=2000, tune=1000)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"48703099bdaa4056a1de3ac62ee9054c\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n:::\n\n\n::: {#d79fcb6c .cell execution_count=16}\n``` {.python .cell-code}\naz.summary(rpois_fit)\n```\n\n::: {.cell-output .cell-output-display execution_count=37}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>mean</th>\n      <th>sd</th>\n      <th>hdi_3%</th>\n      <th>hdi_97%</th>\n      <th>mcse_mean</th>\n      <th>mcse_sd</th>\n      <th>ess_bulk</th>\n      <th>ess_tail</th>\n      <th>r_hat</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Intercept</th>\n      <td>0.865</td>\n      <td>0.884</td>\n      <td>-0.719</td>\n      <td>2.568</td>\n      <td>0.020</td>\n      <td>0.013</td>\n      <td>1951.0</td>\n      <td>2385.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>log_pop</th>\n      <td>0.304</td>\n      <td>0.097</td>\n      <td>0.124</td>\n      <td>0.485</td>\n      <td>0.002</td>\n      <td>0.001</td>\n      <td>1954.0</td>\n      <td>2530.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>contact[low]</th>\n      <td>0.047</td>\n      <td>0.843</td>\n      <td>-1.538</td>\n      <td>1.567</td>\n      <td>0.019</td>\n      <td>0.012</td>\n      <td>1904.0</td>\n      <td>2358.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>log_pop:contact[low]</th>\n      <td>-0.038</td>\n      <td>0.093</td>\n      <td>-0.213</td>\n      <td>0.131</td>\n      <td>0.002</td>\n      <td>0.001</td>\n      <td>1890.0</td>\n      <td>2369.0</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Extração das amostras da posterior\n\n::: {#57d6e818 .cell execution_count=17}\n``` {.python .cell-code}\nrpois_post = rpois_fit.posterior\nbeta_0_samples = rpois_post['Intercept'].values.flatten()\nbeta_1_samples = rpois_post['log_pop'].values.flatten()\nbeta_2_samples = rpois_post['contact'].values.flatten()\nbeta_3_samples = rpois_post['log_pop:contact'].values.flatten()\n```\n:::\n\n\n### Geração de predições (ainda na escala do preditor linear)\n\n::: {#bff868d8 .cell execution_count=18}\n``` {.python .cell-code}\nx_vals = np.linspace(kline['log_pop'].min(), kline['log_pop'].max(), 100)\n\nn_samples = len(beta_0_samples)\npredictions_high = np.zeros((n_samples, len(x_vals)))\npredictions_low = np.zeros((n_samples, len(x_vals)))\n\nfor i in range(n_samples):\n    # Contato 'high' (referência)\n    predictions_high[i] = beta_0_samples[i] + beta_1_samples[i] * x_vals\n    \n    # Contato 'low'\n    predictions_low[i] = (beta_0_samples[i] + beta_2_samples[i]) + (beta_1_samples[i] + beta_3_samples[i]) * x_vals\n```\n:::\n\n\n### Transformando para escala da resposta (contagens esperadas)\n\n::: {#bfd02ad7 .cell execution_count=19}\n``` {.python .cell-code}\n# Aplica exponencial para obter E[Y]\nmu_high = np.exp(predictions_high)\nmu_low = np.exp(predictions_low)\n\n# Médias e intervalos de 95% (na escala original)\nmean_high = mu_high.mean(axis=0)\nmean_low = mu_low.mean(axis=0)\n\nhdi_high = az.hdi(mu_high, hdi_prob=0.95)\nhdi_low = az.hdi(mu_low, hdi_prob=0.95)\n```\n:::\n\n\n### Gráfico com predições e intervalos de credibilidade\n\n::: {#f77bb631 .cell execution_count=20}\n``` {.python .cell-code}\nplt.figure(figsize=(8, 6))\n\n# Gráfico de dispersão\nsns.scatterplot(\n    data=kline, x='population', y='total_tools',\n    hue='contact', palette={'high': '#1f77b4', 'low': '#ff7f0e'},\n    s=150, alpha=0.8\n)\n\n# Intervalos de credibilidade\nplt.fill_between(np.exp(x_vals), hdi_high[:, 0], hdi_high[:, 1],\n                 color='#1f77b4', alpha=0.2, label='95% HDI (high contact)')\nplt.fill_between(np.exp(x_vals), hdi_low[:, 0], hdi_low[:, 1],\n                 color='#ff7f0e', alpha=0.2, label='95% HDI (low contact)')\n\n# Médias posteriores\nplt.plot(np.exp(x_vals), mean_high, color='#1f77b4', linewidth=3, label='Média posterior (high contact)')\nplt.plot(np.exp(x_vals), mean_low, color='#ff7f0e', linewidth=3, label='Média posterior (low contact)')\n\nplt.xlabel('Tamanho populacional', fontsize=14)\nplt.ylabel('Número total de ferramentas', fontsize=14)\nplt.xticks(fontsize=12)\nplt.yticks(fontsize=12)\nplt.legend(loc='upper left', fontsize=10)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](regressao-poisson_files/figure-html/cell-21-output-1.png){width=758 height=566}\n:::\n:::\n\n\n## Um modelo científico: a dinâmica da inovação tecnológica\n\nPartindo do modelo verbal apresentado anteriormente, podemos expressar a mudança esperada no número de ferramentas ao longo do tempo como:\n\n$$\n\\Delta T = \\alpha P^\\beta - \\gamma T\n$$\n\nOnde:\n\n* $P$ é o tamanho da população,\n* $T$ é o número de ferramentas,\n* $\\alpha$, $\\beta$ e $\\gamma$ são parâmetros a serem estimados.\n\nVamos assumir como pressuposto que o número de ferramentas observado está em equilíbrio. Para encontrar o número de ferramentas em equilíbrio, basta definir $\\Delta T = 0$ e resolver para $T$.\n\n::: {.callout-note title=\"Situação de equilíbrio\"}\n\nComeçamos com:\n\n$$\n0 = \\alpha P^\\beta - \\gamma T\n$$\n\nIsolando o termo $T$:\n\n$$\n\\gamma T = \\alpha P^\\beta\n$$\n\nDividindo ambos os lados por $\\gamma$ temos:\n\n$$\nT = \\frac{\\alpha P^\\beta}{\\gamma}\n$${#eq-delta-T-equilibrio}\n\nO valor de $T$ agora representa o **número esperado de ferramentas em equilíbrio**, assumindo que a taxa de inovação ($\\alpha P^\\beta$) é exatamente compensada pela taxa de perda ($\\gamma T$).\n\n* $\\alpha$: controla a **taxa base de inovação**;\n* $\\beta$: define como a **população** afeta essa taxa (exponencialmente);\n* $\\gamma$: representa a **taxa de perda** ou obsolescência de ferramentas.\n\n:::\n\nVamos incorporar @eq-delta-T-equilibrio a um modelo de Poisson, pois essa continua sendo a distribuição adequada para dados de contagem — como `total_tools`, que representa um número inteiro positivo.\n\nVamos assumir portando que a variável aleatória $T$ tem distribuição dada por:\n\n$$\nT_i \\sim \\text{Poisson}(\\lambda_i)\n$$\n\n$$\n\\lambda_i = \\frac{\\alpha P_i^{\\beta}}{\\gamma}\n$$\n\nNão usaremos a função de linação, mas é garantir que $\\lambda$ seja sempre positiva. Para isso, utilizaremos **uma distribuição log-normal** para $\\alpha$ e **distribuições exponenciais** para $\\beta$ e $\\gamma$, assegurando que todos os parâmetros permaneçam positivos.\n\nTambém queremos permitir que esses parâmetros variações com a taxa de contato. Como essa taxa pode mediar a influência do tamanho populacional, podemos modelar $\\alpha$ e $\\beta$ como funções do contato — e até mesmo $\\gamma$, considerando que redes sociais mais densas podem reter ferramentas por mais tempo. A depender do objetivo, podemos permitir diferentes combinações de variação nos parâmetros para capturar os efeitos do contato de forma mais realista.\n\n### O modelo\n\nEscreveremos o modelo em **PyMC** em que os parâmetros $\\alpha$ e $\\beta$ **variam com a taxa de contato** (`contact`: \"high\" ou \"low\"). Queremos modelar:\n\n$$\nT_i \\sim \\text{Poisson}(\\lambda_i), \\quad \\text{onde} \\quad \\lambda_i = \\frac{\\alpha_c P_i^{\\beta_c}}{\\gamma}\n$$\n\nEm que:\n\n* $T_i$: número de ferramentas na ilha $i$\n* $P_i$: população da ilha $i$\n* $c \\in \\{\\text{high}, \\text{low}\\}$: categoria de contato\n* $\\alpha_c$, $\\beta_c$: variam com o nível de contato\n* $\\gamma$: constante positiva (global)\n\n\n### Observação importante\n\nComo o PyMC trabalha melhor com o preditor linear, vamos reparametrizar para usar:\n\n$$\n\\log(\\lambda_i) = \\log(\\alpha_c) + \\beta_c \\cdot \\log(P_i) - \\log(\\gamma)\n$$\n\nou equivalentemente:\n\n$$\n\\log(\\lambda_i) = \\theta_{\\alpha, c} + \\beta_c \\cdot \\log(P_i) + \\theta_\\gamma\n$$\n\nonde:\n\n* $\\theta_{\\alpha, c} = \\log(\\alpha_c)$\n* $\\theta_\\gamma = -\\log(\\gamma)$\n\n### Código em PyMC\n\n::: {#6a9f5eb7 .cell execution_count=21}\n``` {.python .cell-code}\n# Assume: kline DataFrame com colunas 'total_tools', 'population', 'contact'\n# Codificar contato como índice (0 = high, 1 = low)\nkline['contact_code'] = kline['contact'].map({'high': 0, 'low': 1})\nlog_pop = np.log(kline['population'])\ncontact_idx = kline['contact_code'].values\ntools = kline['total_tools'].values\n\nwith pm.Model() as model:\n    # Priors para log(alpha) por grupo de contato\n    theta_alpha = pm.Normal(\"theta_alpha\", mu=0, sigma=2, shape=2)\n    \n    # Priors para beta por grupo de contato\n    beta = pm.Normal(\"beta\", mu=0, sigma=1, shape=2)\n    \n    # Prior para log(gamma)\n    theta_gamma = pm.Normal(\"theta_gamma\", mu=0, sigma=1)\n\n    # Esperança em escala log (link log para Poisson)\n    log_lambda = theta_alpha[contact_idx] + beta[contact_idx] * log_pop + theta_gamma\n    lambda_ = pm.math.exp(log_lambda)\n\n    # Likelihood\n    T_obs = pm.Poisson(\"total_tools\", mu=lambda_, observed=tools)\n\n    # Amostragem\n    trace = pm.sample(2000, tune=1000, target_accept=0.95)\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"150c780d09964b598793523c441ad529\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n```\n:::\n:::\n\n\n---\n\nRecuperando $\\alpha$ e $\\gamma$ de volta a partir dos parâmetros amostrados:\n\n::: {#acb30d9d .cell execution_count=22}\n``` {.python .cell-code}\nimport arviz as az\nposterior = trace.posterior\n\n# Recuperar alpha e gamma\nalpha_samples = np.exp(posterior['theta_alpha'])  # shape (chain, draw, contact)\ngamma_samples = np.exp(-posterior['theta_gamma']) # shape (chain, draw)\n```\n:::\n\n\n",
    "supporting": [
      "regressao-poisson_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script src=\"https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js\" crossorigin=\"anonymous\"></script>\n"
      ],
      "include-after-body": [
        "<script type=application/vnd.jupyter.widget-state+json>\n{\"state\":{\"0159a5b2089b4831b7dec187047b0202\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"150c780d09964b598793523c441ad529\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_82ae9cdbfde24cfba4cd51c2b3ec8a43\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">                                                                                                                   \\n <span style=\\\"font-weight: bold\\\"> Progress                  </span> <span style=\\\"font-weight: bold\\\"> Draws </span> <span style=\\\"font-weight: bold\\\"> Divergences </span> <span style=\\\"font-weight: bold\\\"> Step size </span> <span style=\\\"font-weight: bold\\\"> Grad evals </span> <span style=\\\"font-weight: bold\\\"> Sampling Speed </span> <span style=\\\"font-weight: bold\\\"> Elapsed </span> <span style=\\\"font-weight: bold\\\"> Remaining </span> \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.04        127          212.43 draws/s   0:00:14   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.03        127          221.10 draws/s   0:00:13   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.03        7            235.48 draws/s   0:00:12   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.03        127          196.83 draws/s   0:00:15   0:00:00    \\n                                                                                                                   \\n</pre>\\n\",\"text/plain\":\"                                                                                                                   \\n \\u001b[1m \\u001b[0m\\u001b[1mProgress                 \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDraws\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDivergences\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mStep size\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mGrad evals\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mSampling Speed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mElapsed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mRemaining\\u001b[0m\\u001b[1m \\u001b[0m \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.04        127          212.43 draws/s   0:00:14   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.03        127          221.10 draws/s   0:00:13   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.03        7            235.48 draws/s   0:00:12   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.03        127          196.83 draws/s   0:00:15   0:00:00    \\n                                                                                                                   \\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"24fd7404ea6a46c197bfe143bdaecf54\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_0159a5b2089b4831b7dec187047b0202\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">                                                                                                                   \\n <span style=\\\"font-weight: bold\\\"> Progress                  </span> <span style=\\\"font-weight: bold\\\"> Draws </span> <span style=\\\"font-weight: bold\\\"> Divergences </span> <span style=\\\"font-weight: bold\\\"> Step size </span> <span style=\\\"font-weight: bold\\\"> Grad evals </span> <span style=\\\"font-weight: bold\\\"> Sampling Speed </span> <span style=\\\"font-weight: bold\\\"> Elapsed </span> <span style=\\\"font-weight: bold\\\"> Remaining </span> \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  <span style=\\\"color: #d62728; text-decoration-color: #d62728\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    1             0.16        31           761.10 draws/s   0:00:03   0:00:00    \\n  <span style=\\\"color: #d62728; text-decoration-color: #d62728\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    33            0.12        31           736.12 draws/s   0:00:04   0:00:00    \\n  <span style=\\\"color: #d62728; text-decoration-color: #d62728\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    20            0.11        31           722.79 draws/s   0:00:04   0:00:00    \\n  <span style=\\\"color: #d62728; text-decoration-color: #d62728\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    11            0.13        31           686.64 draws/s   0:00:04   0:00:00    \\n                                                                                                                   \\n</pre>\\n\",\"text/plain\":\"                                                                                                                   \\n \\u001b[1m \\u001b[0m\\u001b[1mProgress                 \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDraws\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDivergences\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mStep size\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mGrad evals\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mSampling Speed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mElapsed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mRemaining\\u001b[0m\\u001b[1m \\u001b[0m \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  \\u001b[38;2;214;39;40m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    1             0.16        31           761.10 draws/s   0:00:03   0:00:00    \\n  \\u001b[38;2;214;39;40m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    33            0.12        31           736.12 draws/s   0:00:04   0:00:00    \\n  \\u001b[38;2;214;39;40m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    20            0.11        31           722.79 draws/s   0:00:04   0:00:00    \\n  \\u001b[38;2;214;39;40m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    11            0.13        31           686.64 draws/s   0:00:04   0:00:00    \\n                                                                                                                   \\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"3cc3d746e0be41e9b12245ee86cd7e19\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"48703099bdaa4056a1de3ac62ee9054c\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_ffdf1b6c7ca44a75a52f2a06124ca705\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">                                                                                                                   \\n <span style=\\\"font-weight: bold\\\"> Progress                  </span> <span style=\\\"font-weight: bold\\\"> Draws </span> <span style=\\\"font-weight: bold\\\"> Divergences </span> <span style=\\\"font-weight: bold\\\"> Step size </span> <span style=\\\"font-weight: bold\\\"> Grad evals </span> <span style=\\\"font-weight: bold\\\"> Sampling Speed </span> <span style=\\\"font-weight: bold\\\"> Elapsed </span> <span style=\\\"font-weight: bold\\\"> Remaining </span> \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.16        31           743.53 draws/s   0:00:04   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.10        31           673.39 draws/s   0:00:04   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.13        15           720.31 draws/s   0:00:04   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.10        7            729.91 draws/s   0:00:04   0:00:00    \\n                                                                                                                   \\n</pre>\\n\",\"text/plain\":\"                                                                                                                   \\n \\u001b[1m \\u001b[0m\\u001b[1mProgress                 \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDraws\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDivergences\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mStep size\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mGrad evals\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mSampling Speed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mElapsed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mRemaining\\u001b[0m\\u001b[1m \\u001b[0m \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.16        31           743.53 draws/s   0:00:04   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.10        31           673.39 draws/s   0:00:04   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.13        15           720.31 draws/s   0:00:04   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.10        7            729.91 draws/s   0:00:04   0:00:00    \\n                                                                                                                   \\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"545c6716925f4b52b3cd4645e824d23b\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_9d455d12c6f0437e833d207f88ac51f1\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">                                                                                                                   \\n <span style=\\\"font-weight: bold\\\"> Progress                 </span> <span style=\\\"font-weight: bold\\\"> Draws </span> <span style=\\\"font-weight: bold\\\"> Divergences </span> <span style=\\\"font-weight: bold\\\"> Step size </span> <span style=\\\"font-weight: bold\\\"> Grad evals </span> <span style=\\\"font-weight: bold\\\"> Sampling Speed  </span> <span style=\\\"font-weight: bold\\\"> Elapsed </span> <span style=\\\"font-weight: bold\\\"> Remaining </span> \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.79        3            2784.61 draws/s   0:00:01   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             1.06        7            2742.59 draws/s   0:00:01   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             1.06        7            2656.58 draws/s   0:00:01   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.75        3            2400.63 draws/s   0:00:01   0:00:00    \\n                                                                                                                   \\n</pre>\\n\",\"text/plain\":\"                                                                                                                   \\n \\u001b[1m \\u001b[0m\\u001b[1mProgress                \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDraws\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDivergences\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mStep size\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mGrad evals\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mSampling Speed \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mElapsed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mRemaining\\u001b[0m\\u001b[1m \\u001b[0m \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.79        3            2784.61 draws/s   0:00:01   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             1.06        7            2742.59 draws/s   0:00:01   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             1.06        7            2656.58 draws/s   0:00:01   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.75        3            2400.63 draws/s   0:00:01   0:00:00    \\n                                                                                                                   \\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"5782c45ad33d47c5a4da47ea76483b52\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_7fedd2698c9247a693406f91b785182d\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">                                                                                                                   \\n <span style=\\\"font-weight: bold\\\"> Progress                  </span> <span style=\\\"font-weight: bold\\\"> Draws </span> <span style=\\\"font-weight: bold\\\"> Divergences </span> <span style=\\\"font-weight: bold\\\"> Step size </span> <span style=\\\"font-weight: bold\\\"> Grad evals </span> <span style=\\\"font-weight: bold\\\"> Sampling Speed </span> <span style=\\\"font-weight: bold\\\"> Elapsed </span> <span style=\\\"font-weight: bold\\\"> Remaining </span> \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.13        63           768.62 draws/s   0:00:03   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.12        15           827.84 draws/s   0:00:03   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.12        15           812.74 draws/s   0:00:03   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.11        23           794.54 draws/s   0:00:03   0:00:00    \\n                                                                                                                   \\n</pre>\\n\",\"text/plain\":\"                                                                                                                   \\n \\u001b[1m \\u001b[0m\\u001b[1mProgress                 \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDraws\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDivergences\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mStep size\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mGrad evals\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mSampling Speed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mElapsed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mRemaining\\u001b[0m\\u001b[1m \\u001b[0m \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.13        63           768.62 draws/s   0:00:03   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.12        15           827.84 draws/s   0:00:03   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.12        15           812.74 draws/s   0:00:03   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.11        23           794.54 draws/s   0:00:03   0:00:00    \\n                                                                                                                   \\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"7fedd2698c9247a693406f91b785182d\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"82365e7566f34b93819a4a241f47c31b\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_3cc3d746e0be41e9b12245ee86cd7e19\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">                                                                                                                   \\n <span style=\\\"font-weight: bold\\\"> Progress                  </span> <span style=\\\"font-weight: bold\\\"> Draws </span> <span style=\\\"font-weight: bold\\\"> Divergences </span> <span style=\\\"font-weight: bold\\\"> Step size </span> <span style=\\\"font-weight: bold\\\"> Grad evals </span> <span style=\\\"font-weight: bold\\\"> Sampling Speed </span> <span style=\\\"font-weight: bold\\\"> Elapsed </span> <span style=\\\"font-weight: bold\\\"> Remaining </span> \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  <span style=\\\"color: #d62728; text-decoration-color: #d62728\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    7             0.12        31           761.63 draws/s   0:00:03   0:00:00    \\n  <span style=\\\"color: #d62728; text-decoration-color: #d62728\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    3             0.14        15           770.67 draws/s   0:00:03   0:00:00    \\n  <span style=\\\"color: #d62728; text-decoration-color: #d62728\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    45            0.12        7            758.91 draws/s   0:00:03   0:00:00    \\n  <span style=\\\"color: #d62728; text-decoration-color: #d62728\\\">━━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    8             0.14        31           671.26 draws/s   0:00:04   0:00:00    \\n                                                                                                                   \\n</pre>\\n\",\"text/plain\":\"                                                                                                                   \\n \\u001b[1m \\u001b[0m\\u001b[1mProgress                 \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDraws\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDivergences\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mStep size\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mGrad evals\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mSampling Speed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mElapsed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mRemaining\\u001b[0m\\u001b[1m \\u001b[0m \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  \\u001b[38;2;214;39;40m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    7             0.12        31           761.63 draws/s   0:00:03   0:00:00    \\n  \\u001b[38;2;214;39;40m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    3             0.14        15           770.67 draws/s   0:00:03   0:00:00    \\n  \\u001b[38;2;214;39;40m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    45            0.12        7            758.91 draws/s   0:00:03   0:00:00    \\n  \\u001b[38;2;214;39;40m━━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    8             0.14        31           671.26 draws/s   0:00:04   0:00:00    \\n                                                                                                                   \\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"82ae9cdbfde24cfba4cd51c2b3ec8a43\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"9d455d12c6f0437e833d207f88ac51f1\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"c4c43555fa3f4c45894658b9431b4fa8\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"f0b3a89f729848be85b75eeccee0e376\":{\"model_module\":\"@jupyter-widgets/output\",\"model_module_version\":\"1.0.0\",\"model_name\":\"OutputModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/output\",\"_model_module_version\":\"1.0.0\",\"_model_name\":\"OutputModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/output\",\"_view_module_version\":\"1.0.0\",\"_view_name\":\"OutputView\",\"layout\":\"IPY_MODEL_c4c43555fa3f4c45894658b9431b4fa8\",\"msg_id\":\"\",\"outputs\":[{\"data\":{\"text/html\":\"<pre style=\\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\\\">                                                                                                                   \\n <span style=\\\"font-weight: bold\\\"> Progress                 </span> <span style=\\\"font-weight: bold\\\"> Draws </span> <span style=\\\"font-weight: bold\\\"> Divergences </span> <span style=\\\"font-weight: bold\\\"> Step size </span> <span style=\\\"font-weight: bold\\\"> Grad evals </span> <span style=\\\"font-weight: bold\\\"> Sampling Speed  </span> <span style=\\\"font-weight: bold\\\"> Elapsed </span> <span style=\\\"font-weight: bold\\\"> Remaining </span> \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             1.00        3            2704.57 draws/s   0:00:01   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.92        7            2779.02 draws/s   0:00:01   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.84        7            2624.13 draws/s   0:00:01   0:00:00    \\n  <span style=\\\"color: #1f77b4; text-decoration-color: #1f77b4\\\">━━━━━━━━━━━━━━━━━━━━━━━━</span>   3000    0             0.76        3            2558.99 draws/s   0:00:01   0:00:00    \\n                                                                                                                   \\n</pre>\\n\",\"text/plain\":\"                                                                                                                   \\n \\u001b[1m \\u001b[0m\\u001b[1mProgress                \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDraws\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mDivergences\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mStep size\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mGrad evals\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mSampling Speed \\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mElapsed\\u001b[0m\\u001b[1m \\u001b[0m \\u001b[1m \\u001b[0m\\u001b[1mRemaining\\u001b[0m\\u001b[1m \\u001b[0m \\n ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             1.00        3            2704.57 draws/s   0:00:01   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.92        7            2779.02 draws/s   0:00:01   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.84        7            2624.13 draws/s   0:00:01   0:00:00    \\n  \\u001b[38;2;31;119;180m━━━━━━━━━━━━━━━━━━━━━━━━\\u001b[0m   3000    0             0.76        3            2558.99 draws/s   0:00:01   0:00:00    \\n                                                                                                                   \\n\"},\"metadata\":{},\"output_type\":\"display_data\"}],\"tabbable\":null,\"tooltip\":null}},\"ffdf1b6c7ca44a75a52f2a06124ca705\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}}},\"version_major\":2,\"version_minor\":0}\n</script>\n"
      ]
    }
  }
}