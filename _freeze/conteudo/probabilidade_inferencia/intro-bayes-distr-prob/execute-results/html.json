{
  "hash": "55b2fdb039ad4b6cc8223db9c9874ba6",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Introdução à Inferência Bayesiana\"  \nsubtitle: \"De contagens a probabilidades\"  \ndescription: Texto adaptado do segundo capítulo (*Small Worlds and Large Worlds*) do livro **Statistical Rethinking – A Bayesian Course with Examples in R and Stan** [@mcelreath2018statistical] e material disponível em [**Statistical Rethinking course and book package**](https://github.com/rmcelreath/rethinking){target=\"_blank\"}  \nCategories: [\"Probabilidade\", \"Inferência bayesiana\", \"teorema de Bayes\"]\n\nimage: \"images/intro-bayes-distr-prob.png\"  \nexecute:  \n  echo: false  \n  warning: false  \n  include: true  \n  message: false  \n\n---\n\n\n\n\n---\n\nVoltemos ao problema das bolinhas de gude. Temos uma caixa contendo quatro bolinhas, que podem ser azuis ou brancas. Sabemos que há exatamente quatro bolinhas, mas não conhecemos a distribuição entre as cores, pois podemos ver apenas uma bolinha por vez através de um orifício. Para estimar quantas bolas de cada cor há na caixa, fazemos uma observação, misturamos as bolinhas, fazemos outra observação e assim por diante. Antes de realizarmos qualquer observação, podemos listar cinco configurações possíveis para o conteúdo da caixa:\n\n1. [⚪⚪⚪⚪]  \n2. [🔵⚪⚪⚪]  \n3. [🔵🔵⚪⚪]  \n4. [🔵🔵🔵⚪]  \n5. [🔵🔵🔵🔵]\n\nNosso objetivo é *estimar o número $N$ de bolas azuis*, o qual pode variar, neste exemplo, de 0 a 4. Como não dispomos de conhecimento prévio sobre a composição da caixa antes da primeira observação, adotamos uma distribuição *a priori* uniforme entre as hipóteses. Assim, cada hipótese recebe uma probabilidade de $p = \\frac{1}{5}$.\n\n| **Hipótese** | **N** | **Priori** |\n|:------------:|:-----:|:----------:|\n| [⚪⚪⚪⚪]   |  0    | $1/5$    |\n| [🔵⚪⚪⚪]   |  1    | $1/5$    |\n| [🔵🔵⚪⚪]   |  2    | $1/5$    |\n| [🔵🔵🔵⚪]   |  3    | $1/5$    |\n| [🔵🔵🔵🔵]   |  4    | $1/5$    |\n\n: **Distribuição de probabilidade *a priori* sobre o conteúdo da caixa** {#tbl-priori} \n\n---\n\n## Distribuições *a priori*, *a posteriori* e *verossimilhança*\n\nSuponha que realizamos três observações da caixa e a sequência registrada seja [🔵, ⚪, 🔵] – ou seja, obtivemos **N = 2** bolas azuis. Para atualizar nosso conhecimento sobre a composição da caixa, combinamos nossa distribuição *a priori* com a verossimilhança de cada hipótese. A verossimilhança é calculada a partir da contagem do número de maneiras em que cada hipótese pode gerar a sequência observada. Em seguida, aplicamos a regra de Bayes, que nos fornece a distribuição *a posteriori* por meio da fórmula:\n\n$$\\text{Posterior}_i = \\frac{\\text{Priori}_i \\times P_i}{\\sum_{j} \\left(\\text{Priori}_j \\times P_j\\right)},$$\n\nonde $P_i$ representa, de forma proporcional, o número de caminhos possíveis para que a hipótese $i$ gere a sequência [🔵, ⚪, 🔵].\n\nNa tabela a seguir, apresentamos os cálculos para cada hipótese:\n\n| **Hipótese** | **N** | **Priori** | **Maneiras de produzir N = 2 [🔵⚪🔵]** | **Posterior** |\n|:------------:|:-----:|:----------:|:---------------------------------------:|:-------------:|\n| [⚪⚪⚪⚪]   |  0    | $1/5$    | $0 \\times 4 \\times 0 = 0$             | $\\dfrac{(1/5 \\times 0)}{\\sum (1/5 \\times \\text{Nº de caminhos})} = 0$  |\n| [🔵⚪⚪⚪]   |  1    | $1/5$    | $1 \\times 3 \\times 1 = 3$             | $\\dfrac{(1/5 \\times 3)}{\\sum (1/5 \\times \\text{Nº de caminhos})} = 0.15$  |\n| [🔵🔵⚪⚪]   |  2    | $1/5$    | $2 \\times 2 \\times 2 = 8$             | $\\dfrac{(1/5 \\times 8)}{\\sum (1/5 \\times \\text{Nº de caminhos})} = 0.40$  |\n| [🔵🔵🔵⚪]   |  3    | $1/5$    | $3 \\times 1 \\times 3 = 9$             | $\\dfrac{(1/5 \\times 9)}{\\sum (1/5 \\times \\text{Nº de caminhos})} = 0.45$  |\n| [🔵🔵🔵🔵]   |  4    | $1/5$    | $4 \\times 0 \\times 4 = 0$             | $\\dfrac{(1/5 \\times 0)}{\\sum (1/5 \\times \\text{Nº de caminhos})} = 0$  |\n\n: **Tabela: Atualização da distribuição de probabilidade combinando a priori e verossimilhança** {#tbl-posteriori} \n\nNa @tbl-posteriori, a coluna *“Maneiras de produzir N = 2 [🔵⚪🔵]”* indica o número de caminhos possíveis para que cada hipótese gere a sequência observada. Note que as hipóteses [⚪⚪⚪⚪] e [🔵🔵🔵🔵] não conseguem gerar a sequência (ou seja, possuem verossimilhança zero). \n\n::: {#86b1fc72 .cell execution_count=1}\n\n::: {.cell-output .cell-output-display}\n![](intro-bayes-distr-prob_files/figure-html/cell-2-output-1.png){width=710 height=279}\n:::\n:::\n\n\nAo normalizarmos os produtos $\\text{Priori}_i \\times P_i$ — isto é, dividindo cada um deles pelo somatório $\\sum (1/5 \\times \\text{Nº de caminhos})$ — obtemos a distribuição **a posteriori**, que representa nosso conhecimento atualizado após considerar as evidências observadas. O resultado final da inferência bayesiana é a atribuição de **probabilidades** — valores não negativos, cuja soma é igual a 1 — a cada uma das hipóteses possíveis sobre o conteúdo da caixa. Essas probabilidades expressam, de forma quantitativa, o quão plausível é cada hipótese à luz dos dados disponíveis.\n\n",
    "supporting": [
      "intro-bayes-distr-prob_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}