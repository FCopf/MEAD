{
  "hash": "0e54609c6d7ea7e2c9038e8fc03a66e3",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Construindo um modelo bayesiano\"  \nsubtitle: \"Verossimilhança e distribuição *a priori*\"  \ndescription: \"Construção de um modelo bayesiano, enfatizando a formulação de distribuições a priori e posterior.\"\nCategories: [\n          \"Inferência bayesiana\",\n          \"Distribuição a priori\",\n          \"Distribuição posterior\",\n          \"Modelo binomial\"\n        ]\nimage: \"images/intro-bayes-modelo-bayesiano.png\"  \nexecute:\n  echo: false\n  warning: false\n  include: true\n  message: false\n---\n\n\n---\n\nConsidere um globo representando o planeta Terra, pequeno o suficiente para caber em suas mãos. Seu objetivo é estimar a fração da superfície coberta por água. Para isso, você adota a seguinte estratégia: joga o globo para cima girando e, ao pegá-lo, registra se o ponto tocado pelo seu dedo indicador direito é água (🌊) ou terra (🏜️). Você repete esse procedimento algumas vezes, obtendo uma sequência de $n$ observações.\n\nVocê faz quatro lançamentos do globo e conta quantos deles resultam em água. Um possível resultado seria $🌊🌊🏜️🌊$, totalizando 3 observações de água e 1 de terra. Outro resultado possível é $🏜️🏜️🌊🌊$, com 2 observações de água e 2 de terra. Para $n = 4$ observações, existem 16 resultados possíveis (@tbl-proporcao-globo).\n\n| Nº |       Dados       | Nº pontos na água | Proporção de pontos na água |\n|:--:|:-----------------:|:-----------------:|:----------------------------:|\n|  1 | 🏜️ 🏜️ 🏜️ 🏜️      | 0                 | 0/4 = 0.00                   |\n|  2 | 🏜️ 🏜️ 🏜️ 🌊      | 1                 | 1/4 = 0.25                   |\n|  3 | 🏜️ 🏜️ 🌊 🏜️      | 1                 | 1/4 = 0.25                   |\n|  4 | 🏜️ 🌊 🏜️ 🏜️      | 1                 | 1/4 = 0.25                   |\n|  5 | 🌊 🏜️ 🏜️ 🏜️      | 1                 | 1/4 = 0.25                   |\n|  6 | 🏜️ 🏜️ 🌊 🌊      | 2                 | 2/4 = 0.50                   |\n|  7 | 🏜️ 🌊 🏜️ 🌊      | 2                 | 2/4 = 0.50                   |\n|  8 | 🏜️ 🌊 🌊 🏜️      | 2                 | 2/4 = 0.50                   |\n|  9 | 🌊 🏜️ 🏜️ 🌊      | 2                 | 2/4 = 0.50                   |\n| 10 | 🌊 🏜️ 🌊 🏜️      | 2                 | 2/4 = 0.50                   |\n| 11 | 🌊 🌊 🏜️ 🏜️      | 2                 | 2/4 = 0.50                   |\n| 12 | 🏜️ 🌊 🌊 🌊      | 3                 | 3/4 = 0.75                   |\n| 13 | 🌊 🏜️ 🌊 🌊      | 3                 | 3/4 = 0.75                   |\n| 14 | 🌊 🌊 🏜️ 🌊      | 3                 | 3/4 = 0.75                   |\n| 15 | 🌊 🌊 🌊 🏜️      | 3                 | 3/4 = 0.75                   |\n| 16 | 🌊 🌊 🌊 🌊      | 4                 | 4/4 = 1.00                   |\n\n: **Resultados possíveis de 4 observações (terra ou água) com o respectivo número e proporção de observações em água.** {#tbl-proporcao-globo .striped .hover}\n\nObserve que apenas um dos resultados contém 4 observações de terra e somente um contém 4 observações de água. Os demais são variações entre esses extremos.\n\nPodemos reorganizar a tabela para evidenciar todas as combinações que levam ao mesmo número $y_i$ de pontos em água:\n\n| Nº pontos na água ($y_i$) | Dados | Nº de combinações |\n|:---------------------------:|:------|:-----------------|\n| 0 | 🏜️ 🏜️ 🏜️ 🏜️ | 1 |\n| 1 | 🏜️ 🏜️ 🏜️ 🌊 <br> 🏜️ 🌊 🏜️ 🏜️ <br> 🏜️ 🏜️ 🌊 🏜️ <br> 🌊 🏜️ 🏜️ 🏜️ | 4 |\n| 2 | 🏜️ 🏜️ 🌊 🌊 <br> 🏜️ 🌊 🏜️ 🌊 <br> 🏜️ 🌊 🌊 🏜️ <br> 🌊 🏜️ 🏜️ 🌊 <br> 🌊 🏜️ 🌊 🏜️ <br> 🌊 🌊 🏜️ 🏜️ | 6 |\n| 3 | 🏜️ 🌊 🌊 🌊 <br> 🌊 🏜️ 🌊 🌊 <br> 🌊 🌊 🏜️ 🌊 <br> 🌊 🌊 🌊 🏜️ | 4 |\n| 4 | 🌊 🌊 🌊 🌊 | 1 |\n\n: **Combinações que resultam em $y_i$ pontos na água.** {#tbl-combinacao-globo tbl-colwidths=\"[25,50,25]\" .striped .hover}\n\n<br>\n\nDefina $p$ como a probabilidade de observar água e $1 - p$ como a probabilidade de observar terra após cada lançamento do globo.\n\nA última linha da @tbl-combinacao-globo (🌊🌊🌊🌊) tem probabilidade:\n$$P(4) = p \\times p \\times p \\times p.$$\n\nEnquanto a primeira linha (🏜️🏜️🏜️🏜️) ocorre com probabilidade:\n$$P(0) = (1 - p) \\times (1 - p) \\times (1 - p) \\times (1 - p).$$\n\nAs linhas correspondentes a $P(1)$, $P(2)$ e $P(3)$ são combinações de $p$ e $(1 - p)$, multiplicadas pelo número de formas pelas quais 1, 2 ou 3 registros de água podem ocorrer em 4 lançamentos.\n\n<br>\n\n| Nº pontos na água ($y$) | Dados | Nº de combinações | $P(Y)$ |\n|:---------------------------:|:------|:-----------------:|:--------|\n| 0 | 🏜️ 🏜️ 🏜️ 🏜️ | 1 | $1 \\times (1-p) \\times (1-p) \\times (1-p) \\times (1-p)$ |\n| 1 | 🏜️ 🏜️ 🏜️ 🌊 <br> 🏜️ 🌊 🏜️ 🏜️ <br> 🏜️ 🏜️ 🌊 🏜️ <br> 🌊 🏜️ 🏜️ 🏜️ | 4 | $4 \\times p \\times (1-p) \\times (1-p) \\times (1-p)$ |\n| 2 | 🏜️ 🏜️ 🌊 🌊 <br> 🏜️ 🌊 🏜️ 🌊 <br> 🏜️ 🌊 🌊 🏜️ <br> 🌊 🏜️ 🏜️ 🌊 <br> 🌊 🏜️ 🌊 🏜️ <br> 🌊 🌊 🏜️ 🏜️ | 6 | $6 \\times p \\times p \\times (1-p) \\times (1-p)$ |\n| 3 | 🏜️ 🌊 🌊 🌊 <br> 🌊 🏜️ 🌊 🌊 <br> 🌊 🌊 🏜️ 🌊 <br> 🌊 🌊 🌊 🏜️ | 4 | $4 \\times p \\times p \\times p  \\times (1-p)$ |\n| 4 | 🌊 🌊 🌊 🌊 | 1 | $1 \\times p \\times p \\times p \\times p$ |\n\n: **Probabilidade $P(Y)$ de observar diferentes números ($y$) de pontos sobre a água.** {#tbl-probabilidade-globo tbl-colwidths=\"[25,30,15,30]\" .striped .hover}\n\n<br>\n\n## O modelo Binomial\n\nA partir das expressões para $P(y)$ apresentadas na @tbl-probabilidade-globo, obtém-se uma fórmula geral que pode ser escrita como:\n\n$$P(y \\mid n, p) = \\binom{n}{y} \\, p^y (1 - p)^{n - y}.\n$${#eq-binomial}\n\n**Onde:**\n\n- $y \\in \\{0, 1, 2, \\dots, n\\}$ é o número de observações de 🌊;\n- $n$ é o número total de observações;\n- $p$ é a fração de 🌊 que cobre o globo;\n- $\\binom{n}{y}$ é o coeficiente binomial, calculado por $\\frac{n!}{y!(n - y)!}$, indicando de quantas maneiras a combinação $p^y (1 - p)^{n - y}$ pode ocorrer.\n\nA @eq-binomial fornece a probabilidade de cada resultado possível (número de observações 🌊) em $n$ tentativas, permitindo calcular a probabilidade de **todos** os possíveis resultados do experimento.\n\n## Verossimilhança: a plausibilidade de uma hipótese\n\n\n\nA partir do modelo binomial, podemos definir a **função de verossimilhança** para um resultado observado. Imagine que, em $n = 4$ lançamentos, foram observados $y = 2$ pontos sobre a água. Não sabemos a verdadeira proporção $p$ de água que cobre a Terra; portanto, fazemos conjecturas e avaliamos cada uma com base nas observações.\n\nPor exemplo, se supormos que a proporção verdadeira seja 40% $(p = 0.4)$, a distribuição binomial determina que a probabilidade de observar $y = 2$ sucessos em $n = 4$ lançamentos seja:\n\n$$P(y = 2 \\mid n = 4, p = 0.4) = \\binom{4}{2} \\, 0.4^2 (1 - 0.4)^{4 - 2} = 0.35$$\n\nEssa hipótese é apenas uma das possíveis. Para ilustrar outras conjecturas, considere:\n\n- Se $p = 0.3$:\n\n  $P(2 \\mid 4, 0.3) = \\binom{4}{2} \\, 0.3^2 (1 - 0.3)^{4 - 2} = 0.26$\n\n- Se $p = 0.8$:\n\n  $P(2 \\mid 4, 0.8) = \\binom{4}{2} \\, 0.8^2 (1 - 0.8)^{4 - 2} = 0.15$\n\nEm cada caso, os dados observados $(y)$ e o número total de observações $(n)$ estão fixos, enquanto o parâmetro $p$ varia conforme a hipótese considerada. Embora a forma matemática seja idêntica à da função de probabilidade binomial, seu uso é diferente. Na função de probabilidade, lemos a *probabilidade de $y$ dado $n$ e $p$*, enquanto nos exemplos acima, avaliamos a **plausibilidade de diferentes hipóteses sobre $p$ dados valores fixos de $y$ e $n$**. \n\nPara evitar confusões, vamos definir a função de verossimilhança como:\n\n$$\n\\mathcal{L}(p \\mid n, y) = \\binom{n}{y} \\, p^y (1 - p)^{n - y}.\n$$ {#eq-likelihood-binomial}\n\nAssim, as verossimilhanças para as três conjecturas específicas sobre a proporção de água na superfície do globo serão:\n\n- $\\mathcal{L}(p = 0.4 \\mid n = 4, y = 2) = 0.35$,\n- $\\mathcal{L}(p = 0.3 \\mid n = 4, y = 2) = 0.26$,\n- $\\mathcal{L}(p = 0.8 \\mid n = 4, y = 2) = 0.15$.\n\nDessa forma, entre as três hipóteses levantadas, aquela em que $p = 0.4$ recebe **maior suporte das evidências**, por estar associada à maior verossimilhança.\n\nPodemos quantificar esse suporte por meio da **razão de verossimilhanças**:\n\n$$RV = \\frac{\\mathcal{L}(p = 0.4 \\mid 4, 2)}{\\mathcal{L}(p = 0.3 \\mid 4, 2)} = \\frac{0.35}{0.26} = 1.35,$$\n\no que indica que, com base nos dados observados, a hipótese de $p = 0.4$ é aproximadamente $1.35$ **vezes mais verossímil** do que a hipótese de $p = 0.3$.\n\n::: {.callout-warning title=\"Resumo: A Função de Verossimilhança Binomial\"}\n\n- A expressão é **matematicamente idêntica** à função de probabilidade binomial, porém interpretada como uma função de $p$ quando os dados $Y$ e $n$ são fixos.\n- A verossimilhança indica a plausibilidade de diferentes valores de $p$ à luz dos dados observados.\n- Na distribuição binomial, lemos: **probabilidade de $Y$ dado $n$ e $p$**.\n- Na função de verossimilhança, interpretamos: **verossimilhança de $p$ dado $n$ e $Y$**.\n- A razão de verossimilhanças pode ser utilizada para quantificar o suporte relativo entre diferentes hipóteses.\n:::\n\n### O perfil de verossimilhança\n\nAcima, foram testadas três conjecturas específicas para a proporção de água na superfície da Terra ($p = 0.3$, $p = 0.4$, $p = 0.8$). Para uma avaliação mais completa, podemos analisar o **perfil de verossimilhança** para uma série de valores de $p$ entre 0 e 1:\n\n::: {#5a5ee5dc .cell execution_count=2}\n\n::: {.cell-output .cell-output-display}\n![](intro-bayes-modelo-bayesiano_files/figure-html/cell-3-output-1.png){width=597 height=451}\n:::\n:::\n\n\nO perfil de verossimilhança indica que, à luz dos nossos dados $y = 2$, a conjectura mais plausível é que a proporção de água que cobre a Terra esteja próxima de 0.5 (neste caso, a verossimilhança máxima é *exatamente* para $p = 0.5$).\n\n## Inferência Bayesiana: distribuições *a priori* e *a posteriori*\n\nA inferência Bayesiana, consiste em utilizar o *Teorema de Bayes* para obter a função de densidade de probabilidade para o(s) parâmetro(s) de interesse, $p(\\theta \\mid Y)$, a partir da função de densidade de probabilidade dos dados condicionais a hipótese, $p(Y \\mid \\theta)$, multiplicada pela a função de densidade de probabilidade *a priori* do parâmetro, $p(\\theta)$:\n\n$$p(\\theta \\mid Y) = \\frac{p(Y \\mid \\theta) \\times p(\\theta)}{p(Y)}$$ {#eq-bayes}\n\nOnde:\n\n- $p(\\theta \\mid Y)$ é a distribuição *posteriori* de $\\theta$ condicional aos dados ($Y$) observados;\n- $p(Y \\mid \\theta)$ é a dstribuição de $Y$ condicional ao parâmetro $\\theta$;\n- $p(\\theta)$ é a distribuição *a priori* de $\\theta$;\n- $p(Y)$ é a probabilidade marginal dos dados ($Y$), calculada como $\\int p(Y \\mid \\theta) \\times p(\\theta) \\, d\\theta$\n\n\nNo contexto bayesiano, podemos utilizar a função de verossimilhança no lugar de $p(Y \\mid \\theta)$, uma vez que matematicamente, as duas funções são idêndicas. \n\nDeste modo, a função de densidade *a posteriori* pode ser expressa como:\n\n$$p(\\theta \\mid Y) = \\frac{\\mathcal{L}(\\theta \\mid Y) \\times p(\\theta)}{p(Y)}$$ {#eq-bayes-likelihood}\n\n## Priori informativa e não informativa\n\nDenominamos *priori* **não informativa** aquela que não acrescenta informações relevantes à distribuição *a posteriori* além daquelas já contidas nos dados observados. Nesses casos, a distribuição *a posteriori* é proporcional apenas à **verossimilhança**:\n\n$$p(\\theta \\mid Y) \\propto \\mathcal{L}(\\theta \\mid Y)$$  {#eq-prop-posteriori-uniforme}\n\nPor outro lado, ao adotarmos uma *priori* **informativa**, atribuímos diferentes densidades de probabilidade às regiões específicas do espaço de parâmetros, refletindo o conhecimento prévio sobre o fenômeno estudado. A distribuição *a posteriori*, nesse caso, será proporcional ao produto entre a verossimilhança e a *priori*, integrando evidências anteriores com a informação contida nos dados:\n\n$$p(\\theta \\mid Y) \\propto \\mathcal{L}(\\theta \\mid Y) \\cdot p(\\theta)$$  {#eq-prop-posteriori-likelihood}\n\nNo modelo binomial aplicado à proporção de água na superfície oceânica, o parâmetro $\\theta$ representa a proporção de água $p$, e sua distribuição posterior é condicional ao número de observações $n$ e aos dados observados $y$.\n\nA distribuição *a priori* para $p$ pode ser **não informativa**, como no caso da distribuição uniforme, que não favorece nenhum valor específico de $p$. Alternativamente, pode-se adotar uma *priori* **informativa**, como a distribuição Beta, que permite ajustar a forma da densidade de probabilidade por meio dos parâmetros $\\alpha$ e $\\beta$, incorporando conhecimento prévio sobre o fenômeno de interesse.\n\nPara ilustrar o efeito de *prioris* informativas e não-informativas sobre a distribuição a posteriori, siga a atividade abaixo:\n\n::: {.callout-tip title=\"Atividades interativas: estimando a proporção da superfície oceânica!\"}\n\n1. **Amostre pontos no globo e faça sua própria inferência bayesiana**  \n   No app abaixo, gere **pontos aleatórios** na superfície da Terra e verifique quantos caem em água ou em terra.  \n   \n   👉 [**Estimando a Proporção da Superfície Oceânica**](https://fcopf-dash-ocean-surface.share.connect.posit.cloud/){target=_blank}\n   \n   - Escolha quantos pontos deseja amostrar (1 a 1000).  \n   - Clique em “Gerar Pontos Aleatórios” e observe quantos ficam sobre a água versus sobre a terra.  \n   - Registre esses valores como $k$ sucessos em $N$ pontos (N observações).\n\n2. **Utilize seus dados na inferência Bayesiana**  \n   Em seguida, abra o app abaixo para visualizar como as observações (sucessos e fracassos) combinadas a diferentes escolhas de parâmetros *a priori* ($\\alpha$, $\\beta$) geram a distribuição *a posteriori*:  \n   \n   👉 [**Inferência Bayesiana**](https://fcopf-binomial-bayesiana.share.connect.posit.cloud/){target=_blank}\n\n   **Dicas de uso**  \n   - Insira o mesmo **número de observações (N)** e **sucessos (k)** obtidos no primeiro app.  \n   - Ajuste interativamente a distribuição *a priori* Beta, modificando os parâmetros $\\alpha$ e $\\beta$.\n   - Observe como a curva azul (“posteriori”) se altera de acordo com a *a priori* e com os dados observados, e compare com o perfil de verossimilhança (curva verde).\n   - Note que ao escolher $\\alpha = 1$ e $\\beta = 1$ a distribuição assume um formato uniforme, tornando-se não-informativa.\n\n:::\n\n",
    "supporting": [
      "intro-bayes-modelo-bayesiano_files"
    ],
    "filters": [],
    "includes": {}
  }
}