{
  "hash": "1fc1adefa3be9188bf75a99bdaeeadad",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Teorema de Bayes\"\ndescription: \"Apresentação do Teorema de Bayes e sua aplicação no cálculo de probabilidades condicionais.\"\ncategories: [\n          \"Teorema de Bayes\",\n          \"Probabilidade condicional\",\n          \"Eventos dependentes\"\n        ]\nimage: \"images/teorema_bayes.png\"\nexecute:\n  echo: true\n  warning: false\n  include: true\n  message: false\n\nformat:\n  html:\n    self-contained: false\n---\n\n\n\n:::{.callout-tip collapse=\"true\"}\n## Pacotes e funções utilizadas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(\"scripts/conditional_tree.r\")\n```\n:::\n\n\n:::\n\nO **Teorema de Bayes** provém da definição de probabilidade condicional:\n\n$$P(B|A) = \\frac{P(A \\cap B)}{P(A)},$$ \n\no que implica:\n\n$$P(A \\cap B) = P(A)\\,P(B|A).$$\n\nPodemos também escrever:\n\n$$P(A|B) = \\frac{P(A \\cap B)}{P(B)}, \\quad P(A \\cap B) = P(B)\\,P(A|B).$$\n\nComo $P(A \\cap B) = P(B \\cap A)$, segue:\n\n$$P(A)\\,P(B|A) = P(B)\\,P(A|B),$$\n\nresultando na forma geral do **Teorema de Bayes**:\n\n$$P(B|A) = \\frac{P(B)\\,P(A|B)}{P(A)}.$$\n\n## Teorema da probabilidade total\n\nConsidere o esquema de um diagrama de árvore:\n\n\n\n::: {.cell layout-align=\"center\" width='8' height='5'}\n::: {.cell-output-display}\n![](teorema_bayes_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\nDois caminhos podem levar à ocorrência de $A$: um em que $B$ ocorre $\\bigl[P(A \\cap B)\\bigr]$ e outro em que $B$ não ocorre $\\bigl[P(A \\cap \\overline{B})\\bigr]$. Por serem mutuamente exclusivos:\n\n$$P(A) = P(A \\cap B) + P(A \\cap \\overline{B}),$$\n\nque pode ser reescrito como:\n\n$$P(A) = P(B)\\,P(A|B) + P(\\overline{B})\\,P(A|\\overline{B}).$$\n\nEste resultado é conhecido como **Teorema da probabilidade total**. Assim, o Teorema de Bayes pode ser expresso por:\n\n$$\nP(B|A) = \\frac{P(B)\\,P(A|B)}{P(B)\\,P(A|B) + P(\\overline{B})\\,P(A|\\overline{B})}.\n$$\n\n## O problema da detecção de espécies\n\nSuponha um estudo sobre a presença de uma espécie de peixe em riachos costeiros da Mata Atlântica. Ela ocorre em 5% dos riachos $\\bigl[P(O) = 0,05\\bigr]$, sendo, portanto, rara. A detecção se dá por captura e identificação taxonômica. Se a espécie está presente, a probabilidade de captura é $0,99$, havendo $0,01$ de **falso negativo** (quando a espécie não é detectada mesmo presente).\n\nHá também a possibilidade de **falso positivo**: mesmo quando ausente, existe uma chance de 0,10 de a espécie ser registrada erroneamente, devido à semelhança com outra espécie presente na região.\n\nPodemos organizar essas probabilidades em um diagrama de árvore:\n\n![Diagrama de árvore representando as probabilidades de ocorrência P(O) e detecção P(D) de uma espécie.](images/Diagrama_Introduzida.png)\n\nAs ramificações mostram as bifurcações do evento “espécie presente ou ausente” e, em seguida, “detecção ou não-detecção”. Assim, são possíveis:\n\n- $P(O \\cap D) = 0,0495$\n- $P(O \\cap \\overline{D}) = 0,0005$\n- $P(\\overline{O} \\cap D) = 0,095$\n- $P(\\overline{O} \\cap \\overline{D}) = 0,855$\n\nA probabilidade total de detecção $P(D)$ é:\n\n$$P(D) = P(O \\cap D) + P(\\overline{O} \\cap D) = 0,0495 + 0,095 = 0,1445.$$\n\n### Razão de verossimilhança, inferência bayesiana e teste de hipóteses\n\nUma pergunta relevante é: \n\n> Ao sabermos de uma possível detecção, podemos ter certeza da presença dessa espécie?\n\nEm *inferência estatística*, buscamos tomar decisões a respeito de um fenômeno desconhecido com base em dados observados. Aqui, exploramos duas abordagens: *verossimilhança* e *inferência bayesiana*.\n\n#### Verossimilhança: uma medida indireta para $P(O|D)$\n\nSe $P(D|O)$ for alta, a presença da espécie se torna mais plausível, pois a chance de detectá-la quando está presente é elevada. Já $P(D|\\overline{O})$ alto indicaria que a não-ocorrência é mais provável, pois há muitos **falsos positivos**.\n\nEm estatística, $P(D|O)$ é análogo à verossimilhança de $O$ dado $D$. De modo simplificado, contrastamos duas hipóteses:\n\n- Espécie ocorre e é detectada;\n- Espécie não ocorre, mas há detecção falsa.\n\nA **razão de verossimilhança** ($RV$) é:\n\n$$RV = \\frac{P(D|O)}{P(D|\\overline{O})} = \\frac{0,99}{0,10} = 9,9.$$\n\nInterpretamos como sendo cerca de 10 vezes mais provável a hipótese “espécie ocorre” do que “espécie não ocorre” quando há detecção.\n\n#### Inferência bayesiana: o conhecimento *a priori* importa?\n\nNa abordagem bayesiana, incluímos a probabilidade *a priori* de ocorrência, $P(O)$. Quando recebemos a informação de detecção, atualizamos essa probabilidade, tornando-a $P(O|D)$.\n\nNo exemplo, conhecemos:\n\n1. $P(O) = 0,05$ e $P(\\overline{O}) = 0,95$;\n2. $P(D|O) = 0,99$ e $P(D|\\overline{O}) = 0,10$.\n\nPelo Teorema de Bayes:\n\n$$P(O|D) = \\frac{P(O)\\,P(D|O)}{P(O)\\,P(D|O) + P(\\overline{O})\\,P(D|\\overline{O})}.$$\n\nSubstituindo valores:\n\n$$P(O|D) = \\frac{0,02 \\times 0,99}{0,02 \\times 0,99 + 0,98 \\times 0,10} \\approx 0.17.$$\n\nE:\n\n$$P(\\overline{O}|D) = \\frac{0,98 \\times 0,10}{0,02 \\times 0,99 + 0,98 \\times 0,10} \\approx 0.83.$$\n\nMesmo com a detecção, a chance de não-ocorrência ainda é maior, favorecendo a hipótese de falso positivo.\n\n#### Diferenças entre as abordagens\n\nA verossimilhança foca em $P(D|O)$, enquanto a inferência bayesiana calcula $P(O|D)$ diretamente, ponderada por $P(O)$. Se $P(O) = 0,5$, então:\n\n$$P(O|D) = \\frac{0,5 \\times 0,99}{0,5 \\times 0,99 + 0,5 \\times 0,10} \\approx 0,91,$$\n$$P(\\overline{O}|D) \\approx 0,09,$$\n\ne a razão $\\frac{P(O|D)}{P(\\overline{O}|D)}$ será igual a $RV = 9,9$, tal como na verossimilhança. Porém, quando $P(O)$ indica uma espécie muito rara, esse valor *a priori* altera o resultado final de $P(O|D)$. Por isso, as duas abordagens só coincidem quando usamos uma *priori* não-informativa (probabilidades iniciais iguais para presença e ausência).\n",
    "supporting": [
      "teorema_bayes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}